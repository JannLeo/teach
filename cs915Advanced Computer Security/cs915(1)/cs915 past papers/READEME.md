![image-20250717153209262](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20250717153209262.png)

这张图片是关于华威大学（University of Warwick）2022年夏季《高级计算机安全》（Advanced Computer Security）考试的考试说明单。以下是详细的解释和总结重点：

### 课程信息：

- **大学**：华威大学（University of Warwick）。
- **课程**：高级计算机安全（Advanced Computer Security），课程代码CS9150_B。
- **考试类型**：2022年夏季标准考试。

### 主要信息：

- **考试时间**：2小时。
- **计算器使用**：考试期间不允许使用计算器，也不需要计算器。
- **考试形式**：
  - 共有**四个问题**。
  - 必须回答**所有四个问题**。

### 重要提示：

- 考生应仔细阅读答题册上的说明，确保在**每本答题册**上填写所需的个人信息。

简而言之，考试时间为2小时，必须回答所有四个问题，且不允许使用计算器。确保在答题册上正确填写所需信息。

![image-20250717154002176](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20250717154002176.png)

这张图片是关于《经典密码学》（Classical Cryptography）的一道考试题，包含了四个小问题。以下是这部分内容的翻译、详细解释以及总结重点：

------

### 题目 1：经典密码学 [25 分]

#### 1.1 替换密码（Substitution cipher）通过随机替换字母来工作，使用排列向量作为密钥。替换密码的密钥大小是多少？请详细阐述在不知道密钥的情况下，替换密码如何被破解。 [5 分]

**解释**：
 替换密码是一种基本的密码加密方法，其中每个字母会被替换为另一个字母，具体替换方式由一个密钥（即排列向量）决定。在没有密钥的情况下，破解这种密码通常依赖于统计分析，例如频率分析（frequency analysis），即分析加密文本中各个字母的出现频率，并与语言中常见字母的频率进行比较。破解的关键是找到字母之间的替换关系。

------

#### 1.2 维吉尼亚密码（Vigenère cipher）旨在解决替换密码的弱点，但它仍然不安全。下面是由维吉尼亚密码生成的密文（假设密钥未知，是多个字母的字符串）：

**...KIOVIEEIGKIOVNURNVNUVKHVMGZIA...**
 请应用卡西斯基测试（Kasinski test）来猜测可能的密钥长度，并解释原因。 [5 分]

**解释**：
 维吉尼亚密码使用字母表的不同位置进行加密，从而增加了破解的难度。卡西斯基测试是一种分析密文的方法，主要通过识别重复的字母序列及其在密文中的位置，推测出密钥的长度。通过计算这些重复序列之间的距离，可以获得密钥长度的可能值。

------

#### 1.3 查找密钥长度的另一种方法是通过计算一致性指数（index of coincidence）。简要解释什么是一致性指数，并说明如何应用一致性指数来确定密钥长度。注意：随机字母的一致性指数为 0.038，而英语文本的一致性指数为 0.065。 [10 分]

**解释**：
 一致性指数是衡量一个文本中字符分布规律性的一种度量。对于英语文本，常见的字母（如 E、T、A 等）会出现得更多，因此英语文本的字符分布更加有规律，而随机文本则没有明显规律。通过计算密文的一致性指数，并与已知的语言一致性指数进行比较，可以估算密钥长度。若一致性指数接近于 0.065，则可能说明密文使用了英语文本和适当的密钥长度。

------

#### 1.4 假设你通过一致性指数方法获得了正确的密钥长度。请解释如何进一步推导出密钥。 [5 分]

**解释**：
 一旦确定了密钥长度，就可以将密文分为若干个组，每组包含相同位置的字母（例如第1、第5、第9个字母为一组，第2、第6、第10个字母为一组等）。然后对每组进行频率分析，找出最有可能的密钥字母。例如，分析每组的字母频率，推测最常出现的字母对应字母表中的常见字母（如 E）。通过这种方式，逐步推导出每个位置的密钥字母，最终得出整个密钥。

------

### 总结重点：

- **1.1**：替换密码的破解方法主要通过频率分析，密钥大小是密文中每个字母的替代范围。
- **1.2**：维吉尼亚密码通过卡西斯基测试，分析重复字母的距离来推测密钥长度。
- **1.3**：一致性指数可以通过分析密文字符的分布规律来推测密钥长度。
- **1.4**：通过一致性指数得到的密钥长度，可以进行分组和频率分析来推导密钥。

这道题测试了经典密码学中常见的加密方法（如替换密码和维吉尼亚密码）及其破解技巧，重点在于分析和推测密钥长度的方法。

如果你需要进一步帮助或解释，欢迎随时联系我！

![image-20250717154057804](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20250717154057804.png)

这张图片是关于《公钥密码学》（Public Key Cryptography）的一道考试题，包含了三部分问题。以下是这部分内容的翻译、详细解释以及总结重点：

------

### 题目 2：公钥密码学 [25 分]

#### 2.1 Bob 是一名软件开发人员，负责为公司所有员工实现一个公钥加密系统。他决定使用 RSA 算法进行公钥加密，并采用 HSM（硬件安全模块）进行密钥管理。他首先在一台主机上生成一个 RSA 模数 n=p×qn = p \times q（其中 pp 和 qq 是素数），然后将这些素数因子保存在安全的 HSM 中。接着，他为每个员工生成一个随机的公钥和私钥（即 e,de, d），并通过公司内部网络将私钥分发给所有员工。

> 在上述设计中存在若干安全漏洞。列出四个漏洞，并简要说明攻击者可能如何利用这些漏洞。 [8 分]

**解释**：
 这个问题要求分析 Bob 的加密系统设计中可能存在的安全问题，可能的漏洞包括：

1. **私钥泄露风险**：如果私钥在公司网络中传输或存储不当，攻击者可能通过中间人攻击或其他方式窃取私钥。
2. **密钥生成安全性**：如果生成的 pp 和 qq 不够随机，攻击者可能通过质因数分解攻击推导出私钥。
3. **HSM安全性**：如果 HSM 的安全性不够高，攻击者可能有机会通过物理或软件攻击来提取存储的素数因子。
4. **内部网络的安全性**：如果公司内部网络不安全，攻击者可以通过网络攻击方式窃取私钥或篡改密钥传输过程。

------

#### 2.2 如果员工丢失了私钥，Bob 计划定义以下 HSM API 来恢复私钥。

**私钥恢复 API**
 Host -> HSM: ee
 HSM -> Host: dd

> 这种方法可行吗？请解释您的答案。 [7 分]

**解释**：
 这个问题要求分析这种私钥恢复方法是否安全。正常情况下，私钥应该始终保存在 HSM 中并且仅在需要时使用。如果私钥 dd 可以通过这样的 API 从 HSM 中提取出来并传输到主机，这可能导致安全漏洞，攻击者可能通过这种方法窃取私钥。因此，这种方法是不安全的，因为它允许私钥在不适当的情况下从 HSM 中提取。

------

#### 2.3 后来，Bob 被要求为每个员工添加一个数字签名功能。为了避免创建新的密钥对，他决定使用相同的 RSA 密钥对进行加密和数字签名。他为每个员工提供了一个程序，执行基本的（或教科书式的）RSA 加密/解密和数字签名，而没有使用任何填充（padding）。

使用相同的密钥对进行 RSA 加密/解密和数字签名是否安全？请阐述您的答案。 [10 分]

**解释**：
 这个问题探讨了使用同一密钥对来执行 RSA 加密和数字签名的安全性。RSA 加密和数字签名本质上有不同的安全需求。使用相同的密钥对进行加密和签名可能存在安全风险，尤其是在没有使用填充的情况下。没有填充的加密操作容易受到选择明文攻击（chosen-plaintext attack）或其他类型的攻击。因此，建议在加密和数字签名中分别使用不同的密钥对或采用适当的填充技术来确保安全。

------

### 总结重点：

- **2.1**：分析了 Bob 的设计中可能的安全漏洞，如私钥泄露、密钥生成、HSM安全性和网络安全性问题。
- **2.2**：私钥恢复API设计存在安全问题，因为它允许私钥从 HSM 中提取并传输给主机，这可能被攻击者利用。
- **2.3**：使用相同的 RSA 密钥对进行加密和数字签名是不安全的，尤其是在没有使用填充的情况下，容易受到各种攻击。

这道题主要考察了公钥密码学中涉及的密钥管理和安全性问题，特别是如何防止私钥泄露及加密和签名的安全实践。

如果你需要进一步的帮助或有其他问题，欢迎随时告诉我！

![image-20250717154203463](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20250717154203463.png)

这是一道关于网络安全中“DNS缓存投毒”（DNS Cache Poisoning）的考试题，来自试卷 CS9150_B，第3题，总分为25分，内容包括DNS投毒攻击的原理、远程与本地攻击的差异、Kaminsky攻击、DNSSEC的应对方法以及分析伪造DNS响应的缓存机制。

------

## 📌 逐题中文解释与重点总结：

------

### **3.1 DNS缓存投毒攻击的工作原理及远程和本地攻击的区别 [5分]**

#### ✅ 问题简述：

简要描述DNS缓存投毒的工作方式，并解释“远程DNS缓存投毒攻击”和“本地DNS缓存投毒攻击”的区别。

#### 📘 中文解释：

DNS缓存投毒攻击是一种攻击方式，攻击者通过向DNS解析器注入伪造的数据，使其缓存错误的DNS解析结果。当用户请求一个合法域名时，就可能被重定向到恶意IP。

- **本地攻击（Local）**：攻击者在本地网络内，能伪装为用户或DNS服务器，更容易控制请求或响应。
- **远程攻击（Remote）**：攻击者无法访问网络，只能伪造UDP响应，必须猜中事务ID（Transaction ID）和源端口，成功难度更高。

------

### **3.2 为什么远程攻击更困难，Kaminsky攻击如何解决这些问题 [10分]**

#### ✅ 问题简述：

指出远程DNS缓存投毒比本地更困难的两个挑战，并解释Kaminsky攻击是如何克服这些挑战的。

#### 📘 中文解释：

远程DNS缓存投毒难点在于：

1. **需要猜中事务ID（Transaction ID）**：DNS请求有16位的事务ID，需准确匹配才能被DNS服务器接受。
2. **需要匹配源端口号**：大多数DNS使用随机源端口，攻击者必须猜对端口。

Kaminsky攻击的技巧：

- **利用并发查询多个子域名（如abc1.example.com，abc2.example.com）**，迫使DNS发出许多请求。
- **并发发送大量伪造响应**，大大增加猜中事务ID和端口号的成功率。

------

### **3.3 DNS协议的根本缺陷与DNSSEC的解决方式 [5分]**

#### ✅ 问题简述：

DNS协议的什么根本问题使其容易受到缓存投毒？DNSSEC是如何解决这一问题的？

#### 📘 中文解释：

根本问题：DNS协议设计时缺乏数据完整性验证机制，即 **未验证响应是否真的来自权威DNS服务器**。

解决方式：

- **DNSSEC（DNS Security Extensions）**使用数字签名来验证DNS记录的真实性。
- 客户端和服务器可验证DNS响应是否由权威服务器签发，防止伪造。

------

### **3.4 分析伪造DNS响应中哪些部分不会被缓存，并解释原因 [5分]**

#### ✅ 场景：

攻击者发送了如下伪造DNS响应（见图片中DNS响应格式）。

#### 📘 中文解释与答案重点：

伪造的DNS响应包括四个部分：

1. **QUESTION SECTION（问题部分）**：
   - 提问：[www.example.com](http://www.example.com/) 的 A 记录
   - ✅ 仅用于查询本身，不缓存。
2. **ANSWER SECTION（答案部分）**：
   - example.com. 的A记录 → ✅ 该部分会被缓存（直接回答了问题）
3. **AUTHORITY SECTION（权威部分）**：
   - example.net. NS 记录
   - example.com. NS 记录
   - ❌ 不会被缓存，因为权威记录的域名不属于被查询的example.com域，和问题域不匹配。
4. **ADDITIONAL SECTION（附加部分）**：
   - 提供了权威NS服务器的IP（glue records）
   - ❌ 不会缓存，因为它们依赖于AUTHORITY部分，且上方NS记录也未被接受或缓存。

#### ✅ 总结：

- ✔️会被缓存：ANSWER SECTION中的example.com A记录
- ❌不会被缓存：AUTHORITY和ADDITIONAL SECTION的内容因域名不相关或不可信而不会被缓存。

------

## 📝 总结重点：

| 小题 | 知识点             | 中文总结                                       |
| ---- | ------------------ | ---------------------------------------------- |
| 3.1  | 缓存投毒原理与分类 | 本地攻击更易控制流量，远程攻击需猜事务ID和端口 |
| 3.2  | Kaminsky攻击       | 通过大量子域名和响应提升远程攻击成功率         |
| 3.3  | DNSSEC             | 使用签名解决DNS协议验证缺陷                    |
| 3.4  | DNS响应缓存机制    | 只有与查询域匹配的有效ANSWER记录会被缓存       |

如需我帮你整理答案格式、提供答题模板或深入讲解某一题，请告诉我！

![image-20250718001233732](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20250718001233732.png)

好的！以下是对你提供的图片（**Question 4: Hardware API Security**）的详细中文解释与重点总结，帮助你完全理解每一个知识点并掌握考试要点。

------

## 📘 问题背景概述

该题展示了IBM 3624硬件安全模块（HSM）如何基于**主账号（PAN）\**计算出银行卡的PIN码。题目还进一步探讨了\**十进制化表（Decimalisation Table）\**的使用方式，以及当银行变更客户账号时，为保持PIN不变引入的新API可能带来的\**安全隐患**。

------

## 🧩 输入数据含义解释

| 字段                    | 值                                    | 含义                    |
| ----------------------- | ------------------------------------- | ----------------------- |
| PAN                     | 4556 2385 7753 2239                   | 客户的主账号            |
| Encrypted PAN           | 3F7C 2201 00CA 8AB3                   | PAN加密结果             |
| Shortened Encrypted PAN | 3F7C                                  | 截取的加密结果前4位     |
| Decimalisation Table    | `0123456789ABCDEF → 0123456789012345` | 十六进制 → 十进制映射表 |
| Decimalised PIN         | 35**                                  | 前两位已知，后两位未知  |
| Public Offset           | 4344                                  | 用于隐藏真实PIN的偏移值 |
| Final PIN               | 7816                                  | 客户实际使用的PIN码     |

------

## ✍️ 4.1 题目详解（5分）

### ❓题目要求：

解释如何利用“十进制化表”生成 Decimalised PIN，并计算其后两位。

------

### ✅ 解题步骤：

1. **Shortened Encrypted PAN = 3F7C**
    拆成四位十六进制字符：3, F, 7, C
2. **使用 Decimalisation Table 映射：**

| HEX  | Decimalisation Table 映射值 | 十进制值 |
| ---- | --------------------------- | -------- |
| 3    | 第4位 → **3**               | 3        |
| F    | 第16位 → **5**              | 5        |
| 7    | 第8位 → **7**               | 7        |
| C    | 第13位 → **2**              | 2        |

1. 得出 Decimalised PIN 为：**3572**

------

### ✅ 核心知识点总结：

- 十六进制“3F7C”通过映射表 → 十进制“3572”
- 所以 **完整的 Decimalised PIN 是 3572**

------

## ✍️ 4.2 题目详解（20分）

### ❓题目要求：

解释如果银行允许通过 API 修改 offset 来保持 Final PIN 不变，**一个内部攻击者**（如银行员工）如何滥用这个 API 以推算出客户的 PIN。

------

### ✅ API 调用说明：

银行向 HSM 发送：

```
Host -> HSM: old_PAN, new_PAN, old_offset
HSM -> Host: new_offset
```

意思是：**给定一个新的 PAN，HSM 将计算新的 offset，以保证最终 PIN 不变**。

------

### ✅ 攻击者的利用方法：

#### 1. 攻击者已知的前提：

- old_PAN（客户账号）已知
- Final PIN（如7816）已知
- old_offset（如4344）可以从系统中获得

#### 2. 攻击者构造输入：

- 构造 new_PAN 为**简单可控的值**，如 "0000000000000000"
- 提供 old_PAN 和 old_offset 给 HSM
- HSM 返回 **new_offset**

#### 3. 利用 new_offset 推出 decimalised PIN：

- HSM保证 Final PIN = (Decimalised PIN + offset) % 10

- 所以：

  ```
  Decimalised PIN = (Final PIN - new_offset) mod 10
  ```

- 攻击者已知 Final PIN 和 new_offset，就能还原出 Decimalised PIN

#### 4. 进而得到原始PIN：

- 已知 decimalisation table
- 攻击者可以尝试不同 Shortened Encrypted PAN 组合，找到唯一与 decimalised PIN 匹配的那一组
- 从而还原出加密数据结构，推导出客户真实PIN

------

### ⚠️ 漏洞本质：

该 API 设计为**保持Final PIN不变**，却泄露了 offset 这一**本应私密的信息**，导致只需提交任意构造的 PAN，攻击者就可以反推出 PIN。

------

## 🧠 重点总结

| 小题 | 知识点            | 中文总结                                              |
| ---- | ----------------- | ----------------------------------------------------- |
| 4.1  | 十进制化表生成PIN | 通过映射表将加密结果转为十进制，拼出完整PIN           |
| 4.2  | API滥用与内部攻击 | 通过构造new PAN骗取HSM返回new offset，进而计算客户PIN |

------

## ✅ 总结一句话

👉 **PIN生成依赖于不可泄露的offset与加密数据，但提供“保持PIN不变”的API等于泄密，使内部人员可轻易恢复客户PIN！**

------

如你希望我将这些内容写成标准英文考试答案或做成思维导图笔记，也可以告诉我！