![image-20250719231731423](READEME.assets/image-20250719231731423.png)

è¿™æ˜¯CS9150è¯¾ç¨‹çš„ä¸€é“æœŸæœ«é¢˜ç›®ï¼Œå±žäºŽâ€œClassical cryptographyï¼ˆç»å…¸å¯†ç å­¦ï¼‰â€éƒ¨åˆ†ï¼Œä¸‹é¢æ˜¯å¯¹é¢˜ç›®çš„é€å¥ç¿»è¯‘ã€è§£é‡Šã€ä»¥åŠç­”é¢˜æ€è·¯åˆ†æžï¼š

------

### ðŸ“˜ **é¢˜ç›®åŽŸæ–‡ç¿»è¯‘**

> **1.1** A substitution cipher works by randomly substituting letters based on using a permutation vector as the key.
>  æ›¿æ¢å¯†ç ï¼ˆSubstitution cipherï¼‰é€šè¿‡ä½¿ç”¨ä¸€ä¸ª**æŽ’åˆ—å‘é‡ï¼ˆpermutation vectorï¼‰**ä½œä¸ºå¯†é’¥ï¼Œéšæœºæ›¿æ¢å­—æ¯æ¥åŠ å¯†ä¿¡æ¯ã€‚

> What is the key size of a substitution cipher?
>  æ›¿æ¢å¯†ç çš„å¯†é’¥ç©ºé—´å¤§å°æ˜¯å¤šå°‘ï¼Ÿ

> Elaborate how a substitution cipher can be broken without knowing the key.
>  è¯·è¯¦ç»†è¯´æ˜Žåœ¨ä¸çŸ¥é“å¯†é’¥çš„æƒ…å†µä¸‹ï¼Œæ›¿æ¢å¯†ç æ˜¯å¦‚ä½•è¢«ç ´è§£çš„ã€‚

> **[5 Marks]**

------

## âœ… **è§£é¢˜è¦ç‚¹æ•´ç†**

è¿™æ˜¯ä¸€ä¸ª**5åˆ†é¢˜ç›®**ï¼Œè€ƒå¯Ÿä¸¤ä¸ªæ ¸å¿ƒå†…å®¹ï¼š

------

### âœ³ï¸ ç¬¬ä¸€é—®ï¼šWhat is the key size of a substitution cipher?

#### âœ”ï¸ ç­”æ¡ˆé€»è¾‘ï¼š

- æ›¿æ¢å¯†ç å¯¹26ä¸ªå­—æ¯è¿›è¡Œé‡æ–°æŽ’åˆ—ã€‚

- æ‰€æœ‰å¯èƒ½çš„æŽ’åˆ—æ•°æ˜¯ï¼š

  26!ï¼ˆ26çš„é˜¶ä¹˜ï¼‰26! \quadï¼ˆ26çš„é˜¶ä¹˜ï¼‰

- è¿™æ˜¯**å¯†é’¥ç©ºé—´ï¼ˆkey spaceï¼‰**çš„å¤§å°ï¼Œæ„å‘³ç€å¯†é’¥çš„æ•°é‡æ˜¯ï¼š

  26!â‰ˆ4Ã—102626! â‰ˆ 4 \times 10^{26}

  éžå¸¸å¤§ï¼Œæ— æ³•é€šè¿‡**ç©·ä¸¾**æš´åŠ›ç ´è§£ã€‚

#### ðŸ“ å¯å†™å‚è€ƒå¥å¼ï¼š

> The key size of a substitution cipher is **26!** (factorial of 26), because each letter in the alphabet is mapped to a unique other letter, and there are 26! possible permutations of the 26 letters.

------

### âœ³ï¸ ç¬¬äºŒé—®ï¼šHow can a substitution cipher be broken without knowing the key?

#### âœ”ï¸ è§£æ³•å…³é”®ï¼š

ä½¿ç”¨**é¢‘çŽ‡åˆ†æžæ³•ï¼ˆFrequency Analysisï¼‰**ï¼š

- è‹±æ–‡ä¸­ä¸åŒå­—æ¯å‡ºçŽ°é¢‘çŽ‡ä¸åŒï¼Œæ¯”å¦‚ï¼š
  - E, T, A, O æ˜¯æœ€å¸¸è§çš„ï¼›
  - Q, Z, X æ˜¯æœ€å°‘è§çš„ã€‚
- å¦‚æžœæœ‰è¶³å¤Ÿé•¿çš„å¯†æ–‡ï¼Œå¯ä»¥ç»Ÿè®¡å…¶ä¸­æ¯ä¸ªå­—æ¯å‡ºçŽ°çš„é¢‘çŽ‡ï¼Œä¸Žè‹±è¯­å¸¸è§é¢‘çŽ‡åˆ†å¸ƒåšåŒ¹é…ï¼Œä»Žè€Œ**æŽ¨æµ‹æ›¿æ¢å…³ç³»**ã€‚
- æ­¤æ–¹æ³•æ˜¯å¯¹â€œå•è¡¨æ›¿æ¢å¯†ç ï¼ˆmonoalphabetic substitution cipherï¼‰â€ç‰¹åˆ«æœ‰æ•ˆã€‚

#### ðŸ“ å¯å†™å‚è€ƒå¥å¼ï¼š

> A substitution cipher can be broken using **frequency analysis**. In English, letters such as **E, T, and A** appear more frequently. By comparing the frequency distribution of letters in the ciphertext with typical English letter frequencies, an attacker can deduce probable mappings between cipher letters and plaintext letters.

------

## ðŸ§  **å®Œæ•´å‚è€ƒç­”æ¡ˆï¼ˆå¯ç›´æŽ¥èƒŒè¯µï¼‰**

> The key size of a substitution cipher is **26!**, which is the number of all possible permutations of the 26 letters in the English alphabet.
>
> Despite the large key space, a substitution cipher can be broken using **frequency analysis**. This technique involves analyzing the frequency of letters in the ciphertext and comparing it with known letter frequencies in English. For example, if a letter appears most frequently in the ciphertext, it might correspond to 'E', the most common letter in English. With enough ciphertext, an attacker can reconstruct the substitution pattern and recover the plaintext without knowing the key.

------

å¦‚æžœä½ è¿˜ä¸ç†Ÿæ‚‰é¢‘çŽ‡è¡¨æˆ–è€…æƒ³ç»ƒç»ƒè¿™ç±»é¢˜ç›®ï¼Œæˆ‘å¯ä»¥æä¾›ä¸€ä¸ªç»ƒä¹ å·¥å…·æˆ–å°ç»ƒä¹ ã€‚éœ€è¦å—ï¼Ÿ

![image-20250722222808562](READEME.assets/image-20250722222808562.png)

è¿™æ˜¯ä¸€ä¸ªå…³äºŽ **VigenÃ¨re cipher** çš„è€ƒè¯•é¢˜ï¼Œè¦æ±‚ä½ ä½¿ç”¨ **Kasiski æ£€éªŒæ³•ï¼ˆKasiski Testï¼‰** æ¥çŒœæµ‹å¯†é’¥é•¿åº¦ï¼Œå¹¶è¯´æ˜Žç†ç”±ã€‚

------

## âœ… é¢˜ç›®ç®€æž

ä½ è¢«ç»™å‡ºä¸€æ®µç”¨ **VigenÃ¨re å¯†ç ** åŠ å¯†çš„å¯†æ–‡ï¼š

```
KIOVIEEIGKIOVNURNVJNUVKHVMGZIA...
```

ç›®æ ‡ï¼š**åˆ©ç”¨ Kasiski æ£€éªŒæ³• çŒœæµ‹å¯†é’¥é•¿åº¦**ã€‚

------

## âœ… Kasiski Test æ˜¯ä»€ä¹ˆï¼Ÿ

Kasiski Test æ˜¯ä¸€ç§ç ´è§£ VigenÃ¨re å¯†ç çš„æ–¹æ³•ï¼ŒåŸºæœ¬æ€è·¯æ˜¯ï¼š

> æ‰¾å‡ºå¯†æ–‡ä¸­é‡å¤çš„å­—ç¬¦ä¸²ï¼ˆé€šå¸¸æ˜¯3ä¸ªæˆ–æ›´å¤šå­—æ¯çš„é‡å¤ç‰‡æ®µï¼‰ï¼Œè®°å½•å®ƒä»¬ä¹‹é—´çš„**é—´è·**ï¼ˆå³å®ƒä»¬å‡ºçŽ°ä½ç½®çš„è·ç¦»ï¼‰ï¼Œç„¶åŽè®¡ç®—è¿™äº›é—´è·çš„ **æœ€å¤§å…¬å› æ•°ï¼ˆGCDï¼‰**ï¼Œä»Žè€ŒçŒœæµ‹å¯†é’¥é•¿åº¦ã€‚

------

## âœ… æ­¥éª¤è¯¦è§£ï¼ˆæ ¹æ®é¢˜ç›®ç»™çš„å¯†æ–‡ï¼‰ï¼š

åŽŸæ–‡ç‰‡æ®µï¼š

```
KIOVIEEIGKIOVNURNVJNUVKHVMGZIA...
```

### **Step 1: æ‰¾é‡å¤å­—ç¬¦ä¸²**

è§‚å¯Ÿå¯†æ–‡ï¼šæˆ‘ä»¬çœ‹åˆ° `KIO` å‡ºçŽ°äº†ä¸¤æ¬¡ï¼š

- ç¬¬ä¸€æ¬¡å‡ºçŽ°çš„ä½ç½®ï¼šç´¢å¼• 0
- ç¬¬äºŒæ¬¡å‡ºçŽ°çš„ä½ç½®ï¼šç´¢å¼• 9

ðŸ”¢ è·ç¦»ï¼ˆé—´éš”ï¼‰= 9 - 0 = **9**

### **Step 2: çœ‹å…¶ä»–é‡å¤**

å†çœ‹ `UV` ä¹Ÿé‡å¤äº†ï¼š

- `UV` å‡ºçŽ°åœ¨ç´¢å¼• 20 å’Œ 24
- é—´è· = 24 - 20 = **4**

ä½†è¿™ç§é‡å¤å¾ˆçŸ­ï¼ŒKasiski æ›´åå¥½ 3 å­—æ¯ä»¥ä¸Šé‡å¤ã€‚

å†çœ‹ `VIE` å’Œ `JNU` å‡ºçŽ°é¢‘æ¬¡è¾ƒä½Žï¼Œå¿½ç•¥ã€‚

æ‰€ä»¥æˆ‘ä»¬åªç”¨å¯é çš„ **"KIO" -> é—´è· 9**ã€‚

------

### **Step 3: æŽ¨æµ‹å¯†é’¥é•¿åº¦**

Kasiski æ£€éªŒçš„æ ¸å¿ƒæ˜¯ï¼š**é‡å¤ä¸²çš„é—´è· = å¯†é’¥é•¿åº¦çš„å€æ•°**

å› ä¸ºåŠ å¯†æ˜¯å‘¨æœŸæ€§çš„ï¼Œå¯†é’¥æ¯éš” N ä¸ªå­—ç¬¦é‡å¤ä¸€æ¬¡ã€‚

æ‰€ä»¥ï¼š
 âž¡ï¸ å¯†é’¥é•¿åº¦æ˜¯ **9 çš„å› æ•°**
 å³å¯èƒ½çš„ key length æ˜¯ï¼š

```
{1, 3, **9**}
```

------

## âœ… ç­”æ¡ˆæ ¼å¼å‚è€ƒï¼ˆé€‚åˆè€ƒè¯•ç­”é¢˜ï¼‰

### âœ… Sample Answer (5 Marks)

**Step 1**: I observed that the 3-letter sequence `KIO` appears twice in the ciphertext. The first occurrence starts at position 0, and the second at position 9.

**Step 2**: The distance between the repeated sequences is 9 characters.

**Step 3**: According to the Kasiski test, the key length is likely a factor of this distance. The factors of 9 are 1, 3, and 9.

**Step 4**: Therefore, the likely key lengths are **1, 3, or 9**, with **3 or 9** being the more probable since a key length of 1 would make it a Caesar cipher.

**Conclusion**: The most likely key lengths are **3 or 9**, based on repeated segments and their spacing (Kasiski method).

------

## ðŸ§  é™„åŠ æç¤ºï¼ˆå¦‚æžœé—®ä½ è¿›ä¸€æ­¥éªŒè¯ï¼‰

ä½ å¯ä»¥ç”¨ **Index of Coincidence (IC)** æˆ– **é¢‘çŽ‡åˆ†æž** å¯¹ä¸åŒ key é•¿åº¦åˆ†æ®µå°è¯•ç ´è¯‘ã€‚

------

å¦‚æžœä½ æƒ³è¦æˆ‘å¸¦ä½ æ‰‹åŠ¨è§£å‡ºè¿™ä¸ªå¯†æ–‡ã€è¿˜åŽŸå‡º key æˆ–æ˜Žæ–‡ï¼Œæˆ‘ä¹Ÿå¯ä»¥ç»§ç»­å¸¦ä½ åšï¼Œç»§ç»­å—ï¼Ÿ

### âœ… æ‰€åœ¨ PPTï¼š

ðŸ“„ **ç¬¬ 3 ä¸ª PPT**ï¼š

> **æ–‡ä»¶å**ï¼š`3 crypto_-_classical.pdf`

## 26é¡µ

![image-20250722223042739](READEME.assets/image-20250722223042739.png)

è¿™å¼ å›¾è¯¦ç»†è§£é‡Šäº† **VigenÃ¨re cipherï¼ˆç»´å‰å°¼äºšå¯†ç ï¼‰** æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œæˆ‘ä»¬ä¸€èµ·æ¥é€è¡Œæ‹†è§£ï¼š

------

## âœ… 1. ä»€ä¹ˆæ˜¯ VigenÃ¨re cipherï¼Ÿ

> ä¸€ç§ **å¤šè¡¨ä»£æ¢åŠ å¯†ï¼ˆpolyalphabetic substitution cipherï¼‰**ï¼Œé€šè¿‡ä½¿ç”¨å¤šä¸ªä¸åŒçš„ Caesar å¯†ç å¾ªçŽ¯å åŠ å®žçŽ°æ›´å¼ºçš„åŠ å¯†æ•ˆæžœã€‚

------

## âœ… 2. å›¾ä¸­å˜é‡è§£é‡Šï¼š

| ç¬¦å· | å«ä¹‰                              |
| ---- | --------------------------------- |
| `k`  | å¯†é’¥ï¼ˆKeyï¼‰é‡å¤æ‰©å±•ä»¥åŒ¹é…æ˜Žæ–‡é•¿åº¦ |
| `m`  | æ˜Žæ–‡ï¼ˆMessageï¼‰è¦åŠ å¯†çš„åŽŸå§‹å†…å®¹   |
| `c`  | å¯†æ–‡ï¼ˆCiphertextï¼‰åŠ å¯†åŽçš„ç»“æžœ    |

------

## âœ… 3. åŠ å¯†æ–¹å¼ï¼ˆå›¾ä¸­å…¬å¼ï¼‰ï¼š

![image-20250722223217921](READEME.assets/image-20250722223217921.png)

------

## âœ… 4. å›¾è§£è¯´æ˜Ž

### åŽŸå§‹å†…å®¹ï¼ˆæŒ‰å­—æ¯å¯¹é½ï¼‰ï¼š

| ä½ç½®          | 1    | 2    | 3    | 4    | 5    | 6    | ...      |
| ------------- | ---- | ---- | ---- | ---- | ---- | ---- | -------- |
| **k**ï¼ˆå¯†é’¥ï¼‰ | A    | B    | C    | A    | B    | C    | é‡å¤å¾ªçŽ¯ |
| **m**ï¼ˆæ˜Žæ–‡ï¼‰ | B    | E    | R    | E    | A    | D    | ...      |
| **c**ï¼ˆå¯†æ–‡ï¼‰ | B    | F    | T    | E    | F    | Y    | ...      |

------

## âœ… ç¤ºä¾‹ï¼šæ‰‹ç®—å‰ä¸‰ç»„åŠ å¯†è¿‡ç¨‹

### ç¬¬1ä¸ªå­—æ¯ï¼š

- æ˜Žæ–‡ `B` â†’ æ•°å­— 1
- å¯†é’¥ `A` â†’ æ•°å­— 0
- åŠ å¯†åŽ = (1 + 0) mod 26 = 1 â†’ å¯†æ–‡ `B`

### ç¬¬2ä¸ªå­—æ¯ï¼š

- æ˜Žæ–‡ `E` â†’ 4
- å¯†é’¥ `B` â†’ 1
- åŠ å¯†åŽ = (4 + 1) mod 26 = 5 â†’ å¯†æ–‡ `F`

### ç¬¬3ä¸ªå­—æ¯ï¼š

- æ˜Žæ–‡ `R` â†’ 17
- å¯†é’¥ `C` â†’ 2
- åŠ å¯†åŽ = (17 + 2) mod 26 = 19 â†’ å¯†æ–‡ `T`

å¦‚æ­¤ç±»æŽ¨ã€‚

------

## âœ… åŠ å¯†æµç¨‹æ€»ç»“ï¼š

1. å°†å¯†é’¥å¾ªçŽ¯ä½¿ç”¨ï¼ˆå¯¹é½æ˜Žæ–‡é•¿åº¦ï¼‰
2. æŠŠå­—ç¬¦è½¬æ¢ä¸ºæ•°å­—ï¼ˆA=0, B=1,...ï¼‰
3. æ¯ä¸€å¯¹å­—æ¯åŠ å’Œå–æ¨¡ 26
4. æŠŠç»“æžœè½¬æ¢å›žå­—æ¯ â†’ å¾—åˆ°å¯†æ–‡

------

## âœ… ä¸ºä»€ä¹ˆ VigenÃ¨re æ¯” Caesar æ›´å¼ºï¼Ÿ

- Caesar åªç”¨ä¸€ä¸ªå›ºå®šåç§»ï¼ˆå•å­—æ¯å¯†é’¥ï¼‰ï¼Œå®¹æ˜“è¢«é¢‘çŽ‡åˆ†æžç ´è§£
- VigenÃ¨re ä½¿ç”¨å¤šä¸ªå­—æ¯å¯†é’¥ï¼Œå¯¹åŒä¸€ä¸ªå­—æ¯åŠ å¯†ç»“æžœä¸åŒ â†’ **æ‰“ç ´å­—æ¯é¢‘çŽ‡è§„å¾‹**
- ä½†ä»å¯è¢« **Kasiski Test** å’Œ **Friedman Test** ç ´è§£

------

å¦‚æžœä½ å¸Œæœ›æˆ‘æ¼”ç¤ºä¸€ç»„è‡ªå·±åŠ å¯†ä¸€æ®µå†…å®¹ï¼Œæˆ–è€…å¸®ä½ åšåå‘è§£å¯†ï¼ˆæš´åŠ›è¿˜åŽŸ keyï¼‰ï¼Œå¯ä»¥ç»§ç»­é—®æˆ‘ ðŸ˜Ž

![image-20250722223352195](READEME.assets/image-20250722223352195.png)

è¿™å¼ å¹»ç¯ç‰‡æ˜¯å¯¹ **VigenÃ¨re cipher çš„ç ´è§£ï¼ˆcryptanalysisï¼‰æ–¹æ³•** çš„æ€»ç»“ï¼ŒæŒ‡å‡ºäº†ä¸¤å¤§æ ¸å¿ƒæ­¥éª¤ï¼š

------

## ðŸ” æ ‡é¢˜ï¼šCryptanalysis of VigenÃ¨re Cipher

ï¼ˆ**ç»´å‰å°¼äºšå¯†ç çš„å¯†ç åˆ†æž**ï¼‰

### ðŸ‘‰ Cryptanalysis = ç ´è§£å¯†ç ï¼Œä¸çŸ¥é“å¯†é’¥çš„æƒ…å†µä¸‹è¿˜åŽŸæ˜Žæ–‡ã€‚

------

## âœ… ä¸¤ä¸ªä¸»è¦æ­¥éª¤è¯¦è§£ï¼š

### ### 1ï¸âƒ£ Find out the key length `m`

**æ‰¾å‡ºå¯†é’¥çš„é•¿åº¦ï¼ˆkey lengthï¼‰**

è¿™æ˜¯ç ´è§£ VigenÃ¨re å¯†ç çš„**ç¬¬ä¸€æ­¥**ï¼Œå¦‚æžœä½ èƒ½ç¡®å®šå¯†é’¥æ˜¯å‡ ä¸ªå­—æ¯çš„ï¼Œé‚£ä¹ˆä½ å°±å¯ä»¥æŠŠæ•´ä¸ªå¯†æ–‡**åˆ†æˆ m ä¸ª Caesar å¯†æ–‡æ¥å•ç‹¬ç ´è§£**ã€‚

#### âœ¨ æ–¹æ³•åŒ…æ‹¬ï¼š

- **Kasiski Test**ï¼ˆé‡å¤å­ä¸² + è·ç¦» â†’ å…¬å› æ•°ï¼‰âœ”ï¸
- **Friedman Test**ï¼ˆç»Ÿè®¡å­—æ¯é‡åˆåº¦ï¼ŒIndex of Coincidenceï¼‰ðŸ“Š

ä¸¾ä¾‹ï¼šå¦‚æžœä½ å‘çŽ°å¯†æ–‡ä¸­å‡ºçŽ° `KIO...KIO`ï¼Œé—´éš”ä¸º 9ï¼Œåˆ™å¯èƒ½å¯†é’¥é•¿åº¦æ˜¯ 3 æˆ– 9ã€‚

------

### ### 2ï¸âƒ£ Find out each letter in the key

**æ‰¾å‡ºå¯†é’¥çš„æ¯ä¸€ä¸ªå­—æ¯**

ç¡®å®šå¯†é’¥é•¿åº¦ `m` åŽï¼Œå°±å¯ä»¥å°†å¯†æ–‡åˆ†ä¸º m ç»„ï¼Œæ¯ç»„éƒ½æ˜¯ç”¨åŒä¸€ä¸ª Caesar åŠ å¯†ï¼š

- æ¯”å¦‚ key é•¿åº¦æ˜¯ 3ï¼Œå°±æŠŠå¯†æ–‡åˆ†ä¸ºç¬¬ 1ã€4ã€7ã€10... ä¸ºç¬¬ 1 ç»„
- ç„¶åŽå¯¹æ¯ç»„åš**é¢‘çŽ‡åˆ†æž**ï¼Œç ´è§£å‡ºè¯¥ç»„ç”¨çš„ Caesar å¯†é’¥ï¼ˆå³ key ä¸­çš„æŸä¸€ä½ï¼‰

#### âœ¨ æŠ€æœ¯æ‰‹æ®µï¼š

- è‹±æ–‡ä¸­ `E` å‡ºçŽ°é¢‘çŽ‡æœ€é«˜ â†’ æŽ¨æµ‹å‡º Caesar åç§»
- å¤šç»„ç»„åˆèµ·æ¥ï¼Œè¿˜åŽŸå‡ºæ•´ä¸ª keyï¼Œæ¯”å¦‚ `B E C O D E`

------

## âœ… å°ç»“ï¼ˆé€‚åˆç­”é¢˜æ—¶å†™ï¼‰

ç»´å‰å°¼äºšå¯†ç ç ´è§£çš„åŸºæœ¬æ€è·¯æ˜¯ä¸¤æ­¥ï¼š

1. **ç¡®å®šå¯†é’¥é•¿åº¦**ï¼šåˆ©ç”¨ Kasiski æˆ– Friedman æ£€éªŒï¼Œé€šè¿‡ç»Ÿè®¡åˆ†æžæˆ–é‡å¤å­ä¸²æŽ¨æµ‹ key é•¿åº¦ã€‚
2. **ç¡®å®šæ¯ä¸ªå¯†é’¥å­—æ¯**ï¼šå°†å¯†æ–‡åˆ†ç»„ï¼Œæ¯ç»„è§†ä¸ºä¸€ä¸ª Caesar å¯†ç ï¼Œç”¨é¢‘çŽ‡åˆ†æžç­‰æ–¹æ³•é€ä¸ªç ´è¯‘å‡º keyã€‚

------

å¦‚æžœä½ æ„¿æ„ï¼Œæˆ‘å¯ä»¥æ•™ä½ å¦‚ä½•æ‰‹åŠ¨ä»Žä¸€ä¸ªå®žé™…ä¾‹å­é‡ŒæŽ¨æµ‹ keyï¼Œæ¯”å¦‚ç”¨ Python å¸®ä½ æ¨¡æ‹Ÿè¿™ä¸¤ä¸ªè¿‡ç¨‹ï¼Œè¦è¯•è¯•å—ï¼Ÿ

![image-20250722223459486](READEME.assets/image-20250722223459486.png)

è¿™å¼ å¹»ç¯ç‰‡è®²çš„æ˜¯ï¼š

# âœ… å¦‚ä½•æ‰¾å‡º VigenÃ¨re å¯†ç çš„å¯†é’¥é•¿åº¦ï¼Ÿ

**ä½¿ç”¨çš„æ–¹æ³•æ˜¯ï¼šKasiski æ£€éªŒæ³•ï¼ˆKasiski Testï¼‰**

------

## ðŸ§  èƒŒæ™¯çŸ¥è¯†ï¼š

VigenÃ¨re å¯†ç çš„ç ´è§£ï¼Œç¬¬ä¸€æ­¥æ˜¯**æ‰¾å‡ºå¯†é’¥é•¿åº¦ `m`**ã€‚
 Kasiski æ£€éªŒæ˜¯ä¸€ç§åŽ†å²æ‚ ä¹…çš„æ–¹æ³•ï¼Œå‘æ˜ŽäºŽ 1863 å¹´ã€‚

------

## âœ… å¹»ç¯ç‰‡å†…å®¹é€æ¡è§£é‡Šï¼š

### ðŸ”¸ æ ‡é¢˜ï¼šHow to find out the key length?

âž¡ï¸ **å¦‚ä½•æ‰¾å‡ºå¯†é’¥é•¿åº¦ï¼Ÿ**

------

### ðŸ”¹ First method: **Kasiski Test**

- **å‘æ˜Žè€…**ï¼šFriedrich Kasiski
- **æ ¸å¿ƒæ€æƒ³**ï¼šæ‰¾å‡ºå¯†æ–‡ä¸­**é‡å¤çš„å­—ç¬¦ä¸²ç‰‡æ®µ**ï¼Œæ¯”å¦‚ç›¸åŒçš„ä¸‰è¿žå­—æ¯ï¼ˆå¦‚ `ABC` å‡ºçŽ°å¤šæ¬¡ï¼‰ï¼Œå¹¶è®¡ç®—å®ƒä»¬ä¹‹é—´çš„**è·ç¦»ï¼ˆä½ç½®é—´éš”ï¼‰**

------

### ðŸ”¹ ä¸¾ä¾‹è¯´æ˜Žï¼š

å¯†æ–‡ç‰‡æ®µç¤ºä¾‹ï¼ˆäººä¸ºç®€åŒ–çš„ä¾‹å­ï¼‰ï¼š

```
ABCDEABCDE...ABCDE...ABCDE
     ^          ^         ^  
```

å‡è®¾ `ABCDE` è¿™ä¸ªé‡å¤å­—ç¬¦ä¸²å‡ºçŽ°äº†å‡ æ¬¡ï¼Œå®ƒä»¬ä¹‹é—´çš„**é—´è·**æ˜¯ 15 ä¸ªå­—ç¬¦ã€‚

------

### ðŸ”¹ å…³é”®æŽ¨ç†ï¼š

**å‡ºçŽ°é—´è·æ˜¯ 15** â†’ æŽ¨æµ‹å¯†é’¥é•¿åº¦æ˜¯ 15 çš„å› å­ï¼š

å¯èƒ½çš„ key é•¿åº¦=å› æ•°(15)=1,3,5,15\text{å¯èƒ½çš„ key é•¿åº¦} = \text{å› æ•°(15)} = 1, 3, 5, 15

é€šå¸¸ä¼šæŽ’é™¤æŽ‰å¤ªå°çš„ï¼ˆå¦‚ 1ï¼‰ï¼Œæ‰€ä»¥æœ€æœ‰å¯èƒ½çš„ key é•¿åº¦æ˜¯ **3 æˆ– 5**ã€‚

> å› ä¸º VigenÃ¨re å¯†ç æ˜¯æŒ‰å¯†é’¥é•¿åº¦ **å‘¨æœŸæ€§** åŠ å¯†çš„ï¼Œ
>  å¦‚æžœä¸¤ä¸ªæ˜Žæ–‡ç‰‡æ®µé—´éš”æ­£å¥½æ˜¯å¯†é’¥çš„æ•´æ•°å€ï¼Œå®ƒä»¬å°±ä¼šè¢« **åŒä¸€å¯†é’¥ç‰‡æ®µåŠ å¯†**ï¼Œ
>  æ‰€ä»¥å®ƒä»¬åŠ å¯†åŽä¼šå¾—åˆ° **ç›¸åŒçš„å¯†æ–‡ç‰‡æ®µ**ï¼Œä»Žè€Œå‡ºçŽ°åœ¨å¯†æ–‡ä¸­é‡å¤ã€‚

------

## âœ… ç»“è®ºæ€»ç»“ï¼š

Kasiski æ–¹æ³•æ­¥éª¤å¦‚ä¸‹ï¼š

1. **æ‰¾åˆ°å¯†æ–‡ä¸­é‡å¤çš„å­ä¸²ï¼ˆâ‰¥3 ä¸ªå­—æ¯ï¼‰**
2. **è®°å½•è¿™äº›å­ä¸²ä¹‹é—´çš„é—´è·**
3. **å¯¹å¤šä¸ªé—´è·å–æœ€å¤§å…¬å› æ•°ï¼ˆGCDï¼‰**
4. **æ‰€æœ‰ GCD çš„å› å­éƒ½æ˜¯å¯èƒ½çš„ key é•¿åº¦**

------

## âœ… åº”ç”¨ç¤ºä¾‹å‚è€ƒä½ å‰é¢çš„é¢˜ç›®ï¼š

æ¯”å¦‚ä½ çœ‹åˆ° `KIO` åœ¨å¯†æ–‡ä¸­é‡å¤å‡ºçŽ°ä¸¤æ¬¡ï¼Œé—´è·æ˜¯ 9 â†’
 å¯èƒ½çš„ key é•¿åº¦ = å› æ•°(9) = **1, 3, 9**

------

å¦‚ä½ æƒ³ï¼Œæˆ‘å¯ä»¥å¸¦ä½ å®Œæ•´åšä¸€ä¸ª Kasiski ç ´è§£ä¾‹é¢˜ï¼ˆå«æ‰¾å­ä¸² + GCD æŽ¨å¯¼ï¼‰ï¼Œæ˜¯å¦ç»§ç»­ï¼Ÿ

![image-20250722223852120](READEME.assets/image-20250722223852120.png)

è¿™å¼ å¹»ç¯ç‰‡è®²çš„æ˜¯ç ´è§£ VigenÃ¨re å¯†ç çš„ç¬¬äºŒç§æ–¹æ³•ï¼š

# âœ… **Friedman Test**ï¼ˆåŸºäºŽ Index of Coincidenceï¼‰

------

## ðŸ” æ ‡é¢˜ï¼šHow to find out the key length?

### ç¬¬äºŒç§æ–¹æ³•ï¼šIndex of Coincidenceï¼ˆé‡åˆæŒ‡æ•°ï¼‰

------

## âœ… å¹»ç¯ç‰‡å†…å®¹é€è¡Œè§£é‡Šï¼š

### ðŸ”¹ **Second method: index of coincidence**

âž¡ï¸ ç¬¬äºŒç§æ–¹æ³•å«åš **é‡åˆæŒ‡æ•°ï¼ˆIndex of Coincidenceï¼Œç®€ç§° ICï¼‰**

------

### ðŸ”¸ Described by William Friedman in 1920

âž¡ï¸ è¿™ä¸ªæ–¹æ³•æ˜¯å¯†ç å­¦å®¶ William Friedman åœ¨ 1920 å¹´æå‡ºçš„ã€‚
 ä»–ä¹Ÿæ˜¯çŽ°ä»£å¯†ç åˆ†æžï¼ˆcryptanalysisï¼‰çš„å…ˆé©±ä¹‹ä¸€ã€‚

------

### ðŸ”¸ Suppose x = xâ‚xâ‚‚...xâ‚™ is a string of n alphabetic characters.

âž¡ï¸ å‡è®¾ä½ æœ‰ä¸€ä¸ªç”± n ä¸ªè‹±æ–‡å­—æ¯ç»„æˆçš„å­—ç¬¦ä¸² `x`ï¼Œä¹Ÿå°±æ˜¯ä½ çš„å¯†æ–‡ã€‚

------

### ðŸ”¸ The Index of Coincidence of x is defined to be the probability that two random elements of x are identical.

âž¡ï¸ **é‡åˆæŒ‡æ•° IC**ï¼š
 æ˜¯ä»Žå­—ç¬¦ä¸²ä¸­**éšæœºæŠ½ä¸¤ä¸ªå­—æ¯**ï¼Œè¿™ä¸¤ä¸ªå­—æ¯æ˜¯**ä¸€æ ·çš„**çš„æ¦‚çŽ‡ã€‚

------

## âœ… è¿™ä¸ªå€¼æœ‰ä»€ä¹ˆç”¨ï¼Ÿä¸ºä»€ä¹ˆèƒ½ç”¨æ¥çŒœ key é•¿åº¦ï¼Ÿ

| åœºæ™¯               | IC å€¼å¤§å°ï¼ˆå¤§è‡´ï¼‰ | è¯´æ˜Ž                                                       |
| ------------------ | ----------------- | ---------------------------------------------------------- |
| **è‹±è¯­è‡ªç„¶æ–‡æœ¬**   | â‰ˆ 0.065           | é¢‘çŽ‡åˆ†å¸ƒä¸å‡ï¼ˆE æœ€å¸¸è§ç­‰ï¼‰                                 |
| **å®Œå…¨éšæœºå­—ç¬¦ä¸²** | â‰ˆ 0.038           | æ‰€æœ‰å­—æ¯ç­‰æ¦‚çŽ‡                                             |
| **VigenÃ¨re å¯†æ–‡**  | ä»‹äºŽä¸¤è€…ä¹‹é—´      | å¦‚æžœçŒœå¯¹ key é•¿åº¦ï¼Œå°±èƒ½è¿˜åŽŸæ¯ä¸€ç»„ä¸º Caesar å¯†ç ï¼ŒIC ä¼šå˜å¤§ |

------

## âœ… ç”¨æ³•æ€»ç»“ï¼š

1. **å°è¯•ä¸åŒçš„ key lengthï¼ˆmï¼‰**
2. å°†å¯†æ–‡åˆ†æˆ m ä¸ªç»„ï¼ˆæ¯ç»„éš” m ä¸ªå­—æ¯ï¼‰
3. åˆ†åˆ«è®¡ç®—æ¯ç»„çš„ IC å€¼
4. å¦‚æžœæŸä¸ª m çš„å¹³å‡ IC æŽ¥è¿‘ 0.065 â†’ è¯´æ˜Žè¿™ä¸ª m å¾ˆå¯èƒ½æ˜¯ key çš„é•¿åº¦ï¼

------

## âœ… ä¸¾ä¸ªä¾‹å­è¯´æ˜Žï¼š

å‡è®¾å¯†æ–‡ä¸ºï¼š

```
CIPHERTEXTENCRYPTEDWITHVIGENERE
```

ä½ è¯• key length = 3ï¼ŒæŠŠå¯†æ–‡åˆ†æˆï¼š

- ç»„1ï¼šç¬¬1ã€ç¬¬4ã€ç¬¬7â€¦ ï¼ˆâ†’ Caesar 1ï¼‰
- ç»„2ï¼šç¬¬2ã€ç¬¬5ã€ç¬¬8â€¦ ï¼ˆâ†’ Caesar 2ï¼‰
- ç»„3ï¼šç¬¬3ã€ç¬¬6ã€ç¬¬9â€¦ ï¼ˆâ†’ Caesar 3ï¼‰

ç„¶åŽåˆ†åˆ«è®¡ç®— ICï¼š

- å¦‚æžœè¿™äº›ç»„çš„ IC éƒ½æŽ¥è¿‘è‹±æ–‡è‡ªç„¶ ICï¼ˆ~0.065ï¼‰ï¼Œè¯´æ˜Žä½ çŒœçš„ key length æ˜¯å¯¹çš„ï¼

------

## âœ… å°ç»“ï¼š

**Index of Coincidence æ˜¯ç”¨äºŽçŒœ key é•¿åº¦çš„ç»Ÿè®¡å·¥å…·**ï¼Œå®ƒé€šè¿‡æ¦‚çŽ‡åˆ†æžåˆ¤æ–­ä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯å¦åƒâ€œè‡ªç„¶è¯­è¨€â€ã€‚
 å½“ä½ ç”¨æ­£ç¡®çš„ key é•¿åº¦åˆ†ç»„ï¼Œç»„å†…çœ‹èµ·æ¥å°±åƒè‹±æ–‡ï¼Œè¿™æ—¶ IC å°±ä¼šæŽ¥è¿‘ 0.065ã€‚

------

å¦‚æžœä½ æƒ³ï¼Œæˆ‘å¯ä»¥çŽ°åœºç”¨ Python ç»™ä½ ç®—ä¸€ä¸ªå¯†æ–‡çš„ IC å€¼ã€å›¾ç¤ºå‡ºä¸åŒ key length çš„å¯èƒ½æ€§å›¾ï¼ˆfrequency analysisï¼‰ï¼Œæ˜¯å¦ç»§ç»­ï¼Ÿ

![image-20250722224126122](READEME.assets/image-20250722224126122.png)

è¿™å¼ å¹»ç¯ç‰‡è¯¦ç»†è®²è§£äº†å¦‚ä½•è®¡ç®— **Index of Coincidenceï¼ˆICï¼Œé‡åˆæŒ‡æ•°ï¼‰**ï¼Œæ˜¯å¯†ç åˆ†æžä¸­éžå¸¸å…³é”®çš„æ•°å­¦å·¥å…·ã€‚ä¸‹é¢æˆ‘ä»¬é€è¡Œæ¥è§£é‡Šï¼š

------

## ðŸ“Œ æ ‡é¢˜ï¼š**Index of Coincidence**

------

## âœ… æ¦‚å¿µè¯´æ˜Žï¼š

### ðŸ”¹ **Suppose a string of n English letters**

å‡è®¾ä½ æœ‰ä¸€ä¸ªé•¿åº¦ä¸º `n` çš„è‹±æ–‡å­—ç¬¦ä¸² `x`ï¼ˆæ¯”å¦‚å¯†æ–‡ï¼‰

------

### ðŸ”¹ **Occurrence of A = fâ‚€**

è¡¨ç¤ºå­—æ¯ **A** åœ¨è¿™ä¸ªå­—ç¬¦ä¸²ä¸­å‡ºçŽ°äº† `fâ‚€` æ¬¡

### ðŸ”¹ **Occurrence of B = fâ‚**

è¡¨ç¤ºå­—æ¯ **B** å‡ºçŽ°äº† `fâ‚` æ¬¡

...

### ðŸ”¹ **Occurrence of Z = fâ‚‚â‚…**

è¡¨ç¤ºå­—æ¯ **Z** å‡ºçŽ°äº† `fâ‚‚â‚…` æ¬¡

------

## âœ… ä»€ä¹ˆæ˜¯ Index of Coincidenceï¼Ÿ

> æ˜¯åœ¨å­—ç¬¦ä¸²ä¸­**éšæœºé€‰ä¸¤ä¸ªå­—ç¬¦ï¼Œå®ƒä»¬æ˜¯ä¸€æ ·çš„æ¦‚çŽ‡**ã€‚

------

- ![image-20250722224509121](READEME.assets/image-20250722224509121.png)

------

## âœ… å¸¸è§çš„ IC å€¼ï¼š

| å­—ç¬¦ä¸²ç±»åž‹    | å…¸åž‹ IC å€¼   | è¯´æ˜Ž                             |
| ------------- | ------------ | -------------------------------- |
| è‹±æ–‡æ­£å¸¸å¥å­  | ~0.065       | å‡ºçŽ°é¢‘çŽ‡ä¸å¹³å‡ï¼ŒE/T/A å¤š         |
| éšæœºå­—ç¬¦ä¸²    | ~0.038       | å­—æ¯åˆ†å¸ƒå‡åŒ€                     |
| VigenÃ¨re å¯†æ–‡ | ä»‹äºŽä¸¤è€…ä¹‹é—´ | è¶Šé•¿å¯†é’¥è¶Šéšæœºï¼Œè¶ŠçŸ­å¯†é’¥è¶Šåè‹±æ–‡ |

------

## ðŸ§  ç”¨é€”å›žé¡¾ï¼š

å¦‚æžœä½ å°è¯•ç”¨ä¸åŒ key length åŽ»åˆ‡åˆ† VigenÃ¨re å¯†æ–‡ï¼š

- å¦‚æžœç”¨å¯¹äº† key é•¿åº¦ï¼Œæ¯ç»„å­ä¸²å°±æ˜¯ Caesar å¯†æ–‡ï¼ŒæŽ¥è¿‘è‹±æ–‡ â†’ **IC â‰ˆ 0.065**
- å¦‚æžœçŒœé”™ï¼Œç»„å†…å­—æ¯åˆ†å¸ƒåéšæœº â†’ **IC â‰ˆ 0.038**

------

## âœ… æ€»ç»“ï¼š

1. IC è¡¡é‡çš„æ˜¯å­—ç¬¦ä¸²ä¸­å­—æ¯çš„é›†ä¸­ç¨‹åº¦
2. ç”¨äºŽè¯†åˆ« **VigenÃ¨re å¯†æ–‡çš„ key é•¿åº¦**
3. è®¡ç®—æ–¹æ³•å°±æ˜¯ï¼šçœ‹æ¯ä¸ªå­—æ¯å‡ºçŽ°æ¬¡æ•°ï¼Œè®¡ç®—é‡å¤æ¦‚çŽ‡

------

å¦‚æžœä½ æƒ³ï¼Œæˆ‘å¯ä»¥ç”¨ä¸€æ®µçœŸå®žå¯†æ–‡ï¼Œå¸¦ä½ æ‰‹åŠ¨ç®—ä¸€æ¬¡ IC æˆ–ç”»å‡ºä¸åŒ key length ä¸‹çš„ IC æ›²çº¿å›¾ï¼Œå¸®ä½ æ›´ç›´è§‚ç†è§£ã€‚è¦è¯•è¯•çœ‹å—ï¼Ÿ

![image-20250722224527935](READEME.assets/image-20250722224527935.png)

è¿™å¼ å¹»ç¯ç‰‡æ˜¯åœ¨æ€»ç»“ **ä¸åŒç±»åž‹æ–‡æœ¬çš„ Index of Coincidenceï¼ˆICï¼‰ çš„å·®å¼‚**ï¼Œç”¨æ¥è§£é‡Š **ä¸ºä»€ä¹ˆå¯ä»¥é€šè¿‡ IC åˆ¤æ–­å¯†é’¥é•¿åº¦**ï¼Œæ˜¯ Friedman åˆ†æžæ³•çš„æ ¸å¿ƒä¾æ®ã€‚

------

## âœ… æ ‡é¢˜ï¼šDifference in index of coincidence

**å„ç§å­—ç¬¦ä¸²çš„ IC å€¼å¯¹æ¯”**

------

## ðŸ§  èƒŒæ™¯å›žé¡¾ï¼š

IC æ˜¯æŒ‡ï¼š**ä»Žå­—ç¬¦ä¸²ä¸­éšæœºæŠ½ä¸¤ä¸ªå­—æ¯ï¼Œè¿™ä¸¤ä¸ªå­—æ¯ä¸€æ ·çš„æ¦‚çŽ‡**

------

ä¸‹é¢æˆ‘ä»¬è§£é‡Šå››ç§ç±»åž‹çš„æ–‡æœ¬å’Œå®ƒä»¬çš„ IC å€¼ï¼š

------

### ðŸ”¹ 1. **Normal English textï¼ˆæ­£å¸¸è‹±æ–‡ï¼‰**

- å­—æ¯å‡ºçŽ°é¢‘çŽ‡å·®åˆ«å¾ˆå¤§ï¼ˆE/T/A å¾ˆå¤šï¼ŒQ/Z å¾ˆå°‘ï¼‰
- æ‰€ä»¥æœ‰æ›´é«˜çš„â€œé‡å¤å­—æ¯â€æ¦‚çŽ‡
- **IC â‰ˆ 0.065**

------

### ðŸ”¹ 2. **Completely random string of lettersï¼ˆå®Œå…¨éšæœºï¼‰**

- æ¯ä¸ªå­—æ¯éƒ½æ˜¯å¹³å‡å‡ºçŽ°ï¼Œåƒå¯†ç éšæœºç”Ÿæˆä¸€æ ·
- æ‰€ä»¥é‡å¤æ¦‚çŽ‡æ›´ä½Ž
- **IC â‰ˆ 0.038**

------

### ðŸ”¹ 3. **Normal English text shifted by a fixed numberï¼ˆå‡¯æ’’å¯†ç ï¼‰**

- è¿™å°±æ˜¯ **Caesar cipher** åŠ å¯†åŽçš„ç»“æžœï¼ˆæ¯ä¸ªå­—æ¯åç§»å›ºå®šæ•°ï¼‰
- å­—æ¯é¢‘çŽ‡åˆ†å¸ƒå®Œå…¨æ²¡æœ‰æ”¹å˜ï¼Œåªæ˜¯è¢«â€œæ¢äº†åå­—â€
- æ‰€ä»¥å’ŒåŽŸæ–‡ä¸€æ ·ï¼ŒIC ä¸å˜
- **IC â‰ˆ 0.065**

------

### ðŸ”¹ 4. **English text encrypted by VigenÃ¨re cipher**

- VigenÃ¨re æ˜¯å¤šä¸ª Caesar å¯†ç è½®æµä½¿ç”¨ï¼ˆpoly-alphabeticï¼‰
- éšç€å¯†é’¥é•¿åº¦å˜å¤§ï¼Œåˆ†å¸ƒé€æ¸å˜å¾—æ›´å¹³å‡ï¼Œæ›´éšæœº
- æ‰€ä»¥ï¼š**IC ä»‹äºŽ 0.038 ~ 0.065 ä¹‹é—´**

**IC å€¼èŒƒå›´åˆ¤æ–­å¦‚ä¸‹ï¼š**

| Key Length | å¯†æ–‡è¶Šåƒè‹±æ–‡ â†’ IC è¶Šé«˜                |
| ---------- | ------------------------------------- |
| Key çŸ­     | å­—æ¯è§„å¾‹æ€§å¼º â†’ **IC â†‘**ï¼ˆæŽ¥è¿‘ 0.065ï¼‰ |
| Key é•¿     | å­—æ¯æŽ¥è¿‘éšæœº â†’ **IC â†“**ï¼ˆæŽ¥è¿‘ 0.038ï¼‰ |

------

## âœ… ç”¨æ³•æ€»ç»“ï¼š

é€šè¿‡è®¡ç®—å¯†æ–‡çš„ ICï¼š

- å¦‚æžœ IC æŽ¥è¿‘ **0.065** â†’ å¾ˆå¯èƒ½æ˜¯è‹±æ–‡æˆ– Caesar å¯†æ–‡
- å¦‚æžœ IC æŽ¥è¿‘ **0.038** â†’ å¾ˆå¯èƒ½æ˜¯éšæœºæˆ– VigenÃ¨re å¯†é’¥å¾ˆé•¿
- å¦‚æžœä½ ç”¨æŸä¸ª key length æŠŠå¯†æ–‡åˆ†ç»„ï¼Œæ¯ç»„ IC éƒ½ â‰ˆ 0.065
   â†’ **çŒœå¯¹äº† key lengthï¼**

------

## âœ… å¡«ç©ºç­”æ¡ˆï¼ˆæœ€åŽä¸€é¡¹ï¼‰ï¼š

> **English text encrypted by VigenÃ¨re cipher**
>  IC â‰ˆ **0.038 ~ 0.065**
>  ï¼ˆä¸€èˆ¬åœ¨ 0.045 ~ 0.055 ä¹‹é—´ï¼‰

------

éœ€è¦æˆ‘ä¸¾ä¾‹æ¼”ç¤ºç”¨ IC çŒœ key length çš„ Python è„šæœ¬å—ï¼Ÿæˆ–è€…ä½ æƒ³ç»ƒä¹ ä¸€é“ä¾‹é¢˜ï¼Ÿ

![image-20250722224711403](READEME.assets/image-20250722224711403.png)

è¿™æ˜¯ä¸€é“å…¸åž‹çš„å…³äºŽ **Index of Coincidence (IC)** çš„ç®€ç­”é¢˜ï¼Œè€ƒæŸ¥ä½ å¯¹å…¶**å®šä¹‰å’Œåº”ç”¨æ–¹æ³•çš„ç†è§£**ã€‚

------

## âœ… ä¸­æ–‡ç¿»è¯‘ + é¢˜æ„è¯´æ˜Žï¼š

**é¢˜ç›®å†…å®¹ï¼š**

> 1.3 å¦ä¸€ç§çŒœæµ‹å¯†é’¥é•¿åº¦çš„æ–¹æ³•æ˜¯é€šè¿‡è®¡ç®—é‡åˆæŒ‡æ•°ï¼ˆIndex of Coincidenceï¼‰ã€‚è¯·ç®€è¦è¯´æ˜Žï¼š
>
> 1. ä»€ä¹ˆæ˜¯ ICï¼›
> 2. å¦‚ä½•é€šè¿‡ IC æ¥åˆ¤æ–­å¯†é’¥é•¿åº¦ã€‚
>
> æç¤ºï¼šéšæœºå­—æ¯çš„ IC â‰ˆ 0.038ï¼Œè‹±è¯­æ–‡æœ¬çš„ IC â‰ˆ 0.065ã€‚
>  ã€10åˆ†ã€‘

------

## âœ… è§£é¢˜ç»“æž„ï¼ˆå†™ä½œå»ºè®®ï¼Œé€»è¾‘æ¸…æ™°å¯æ‹¿æ»¡åˆ†ï¼‰ï¼š

------

### **ç¬¬ä¸€éƒ¨åˆ†ï¼šè§£é‡Šä»€ä¹ˆæ˜¯ Index of Coincidence**ï¼ˆ4 åˆ†ï¼‰

> The Index of Coincidence (IC) is a statistical measure that estimates the probability that two randomly selected letters from a string are identical.
>
> It is calculated using the formula:

IC = \frac{\sum_{i=0}^{25} f_i(f_i - 1)}{n(n - 1)}
 ]

> where fif_i is the number of times letter ii appears and nn is the total number of letters.

âž¡ï¸ ä¸­æ–‡ï¼šé‡åˆæŒ‡æ•°æ˜¯æŒ‡ä»Žä¸€ä¸ªå­—ç¬¦ä¸²ä¸­éšæœºæŠ½ä¸¤ä¸ªå­—ç¬¦ï¼Œå®ƒä»¬æ˜¯**ç›¸åŒå­—æ¯**çš„æ¦‚çŽ‡ã€‚
 âž¡ï¸ å¦‚æžœå­—æ¯é¢‘çŽ‡ä¸å‡åŒ€ï¼ˆå¦‚è‹±æ–‡æ–‡æœ¬ï¼‰ï¼ŒIC å€¼å°±ä¼šåå¤§ã€‚

------

### **ç¬¬äºŒéƒ¨åˆ†ï¼šå¦‚ä½•åˆ©ç”¨ IC çŒœå¯†é’¥é•¿åº¦**ï¼ˆ6 åˆ†ï¼‰

> To determine the key length in a VigenÃ¨re cipher using IC:
>
> 1. Guess a potential key length mm.
> 2. Divide the ciphertext into mm groups, each containing every mm-th letter.
> 3. Compute the IC of each group.
> 4. If the average IC is close to **0.065**, then this mm is likely the correct key length.
> 5. If the IC is close to **0.038**, it likely indicates random distribution â€” try another key length.

âž¡ï¸ ä¸­æ–‡æ€è·¯æ€»ç»“ï¼š

1. å‡è®¾å¯†é’¥é•¿åº¦ä¸º m
2. æŠŠå¯†æ–‡æ¯ m ä¸ªä¸€ç»„åˆ†æˆ m ä¸ªå­åºåˆ—
3. æ¯ä¸ªå­åºåˆ—éƒ½åƒæ˜¯ä¸€ä¸ª Caesar å¯†ç ï¼ˆå›ºå®šåç§»ï¼‰
4. åˆ†åˆ«è®¡ç®—è¿™ m ä¸ªåºåˆ—çš„ ICï¼Œæ±‚å¹³å‡
5. å¦‚æžœå¹³å‡å€¼æŽ¥è¿‘ 0.065 â†’ çŒœå¯¹äº† key é•¿åº¦
    å¦‚æžœæŽ¥è¿‘ 0.038 â†’ key é•¿åº¦çŒœé”™äº†ï¼Œè¦æ¢åˆ«çš„

------

## âœ… æ ·æ¿ç­”æ¡ˆï¼ˆè‹±æ–‡å†™æ³•å»ºè®®ï¼‰ï¼š

> The Index of Coincidence (IC) measures the likelihood that two randomly selected letters from a text are the same. In English text, where letter frequencies vary (e.g., E is most common), the IC is about 0.065. In completely random text, the IC is about 0.038.
>
> To determine the key length of a VigenÃ¨re cipher using IC, one assumes a possible key length mm, then divides the ciphertext into mm groups, each taking every mm-th character. The IC of each group is calculated. If the average IC is close to 0.065, it indicates each group resembles English text encrypted by Caesar cipher, and the key length is likely correct. Otherwise, try another value of mm.

------

å¦‚ä½ éœ€è¦ï¼Œæˆ‘ä¹Ÿå¯ä»¥ï¼š

- å¸®ä½ ç›´æŽ¥å†™ä¸€ä»½ä¸­æ–‡ç‰ˆæœ¬
- å¸®ä½ å†™æˆ Markdown/Word ç»“æž„
- æˆ–è€…ç”¨ Python å·¥å…·æ¼”ç¤ºä¸€ä¸ª IC å®žé™…è®¡ç®—è¿‡ç¨‹

éœ€è¦çš„è¯è¯·å‘Šè¯‰æˆ‘ ðŸ˜„

![image-20250722224847675](READEME.assets/image-20250722224847675.png)

è¿™æ˜¯ä¸€ä¸ªå…³äºŽ **VigenÃ¨re å¯†ç ç ´è¯‘**ä¸­ç¬¬äºŒé˜¶æ®µçš„é—®é¢˜ï¼š
 **ä½ å·²ç»çŸ¥é“äº†å¯†é’¥é•¿åº¦ï¼Œä¸‹ä¸€æ­¥å¦‚ä½•æŽ¨å¯¼å‡ºå¯†é’¥æœ¬èº«ï¼Ÿ**

------

## âœ… ä¸­æ–‡ç¿»è¯‘ï¼š

**1.4** å‡è®¾ä½ å·²ç»é€šè¿‡ index of coincidence æ–¹æ³•æ­£ç¡®æ‰¾åˆ°äº†å¯†é’¥é•¿åº¦ã€‚
 è¯·è§£é‡Šä½ æŽ¥ä¸‹æ¥å¦‚ä½•æŽ¨å¯¼å‡ºå¯†é’¥ã€‚
 ã€5 åˆ†ã€‘

------

## âœ… å›žç­”ç»“æž„ï¼ˆé€‚åˆè€ƒè¯•å†™ä½œï¼‰ï¼š

------

### ðŸŒŸ å‰æï¼šä½ çŸ¥é“å¯†é’¥é•¿åº¦æ˜¯ m

é‚£ä¹ˆå¯ä»¥æŠŠå¯†æ–‡åˆ†æˆ m ä¸ªå­åºåˆ—ï¼Œæ¯ä¸ªå­åºåˆ—éƒ½æ˜¯ä¸€ä¸ª**Caesar å¯†ç ï¼ˆå‡¯æ’’å¯†ç ï¼‰**åŠ å¯†çš„ã€‚

------

### âœ… è§£é¢˜æ­¥éª¤ï¼ˆè‹±æ–‡ + ä¸­æ–‡è§£é‡Šï¼‰ï¼š

> 1. Divide the ciphertext into mm separate groups, each containing letters encrypted with the same Caesar shift.
>     âž¤ å°†å¯†æ–‡æŒ‰å¯†é’¥é•¿åº¦ mm åˆ†æˆ m ä¸ªç»„ï¼Œä¾‹å¦‚æ¯ç¬¬ ii ä¸ªå­—æ¯å½’ä¸ºç¬¬ ii ç»„ã€‚

> 1. For each group, perform **frequency analysis** to identify the Caesar shift used.
>     âž¤ å¯¹æ¯ç»„åˆ†åˆ«åš**å­—æ¯é¢‘çŽ‡åˆ†æž**ï¼Œæ‰¾å‡ºæœ€å¸¸å‡ºçŽ°çš„å­—æ¯ï¼ˆæ¯”å¦‚ â€˜Eâ€™ æ˜¯è‹±æ–‡ä¸­æœ€å¸¸è§çš„ï¼‰ï¼ŒæŽ¨æµ‹å®ƒæ˜¯ç”±å“ªä¸ªæ˜Žæ–‡å­—æ¯åŠ å¯†è€Œæ¥ã€‚

> 1. Calculate the Caesar shift by comparing the observed most frequent letter with the expected one (typically 'E' in English).
>     âž¤ ä¾‹å¦‚è¿™ä¸€ç»„ä¸­ 'B' æœ€å¸¸è§ï¼Œä½ å¯ä»¥çŒœå®ƒæ˜¯ 'E' è¢«åŠ å¯†è€Œæ¥ â†’ Caesar shift æ˜¯ 23ï¼ˆå› ä¸º Eâ†’B æ˜¯ -3 mod 26ï¼‰

> 1. This Caesar shift corresponds to the key letter used for that group.
>     âž¤ æŠŠæ¯ç»„çš„ Caesar shift è½¬æ¢ä¸ºå¯†é’¥å­—æ¯ï¼ˆ0â†’Aï¼Œ1â†’Bï¼Œ...ï¼‰

> 1. Repeat this process for all mm groups to get the full key.
>     âž¤ æœ€ç»ˆä½ å¾—åˆ°äº†å®Œæ•´çš„å¯†é’¥ï¼Œå¦‚ "LEMON"ã€‚

------

## âœ… æ€»ç»“ï¼ˆä¸€å¥è¯ç²¾ç‚¼ï¼‰ï¼š

> By treating each group as a Caesar cipher and using frequency analysis on each, we can recover each letter of the VigenÃ¨re key.

------

## âœ… æ ·æ¿è‹±æ–‡ç­”æ¡ˆï¼ˆè€ƒè¯•å¯ç”¨ï¼‰ï¼š

> Once the key length mm is known, the ciphertext is divided into mm groups, each consisting of every mm-th letter. Each group corresponds to a Caesar cipher.
>
> By performing frequency analysis on each group, we estimate the shift by assuming the most frequent letter in each group corresponds to 'E' (the most common English letter).
>
> The shift reveals the key letter for that group. Repeating this for all mm groups gives the complete VigenÃ¨re key.

------

éœ€è¦æˆ‘å¸®ä½ åšä¸€ä¸ªé¢‘çŽ‡åˆ†æžçš„å°ä¾‹å­ï¼ˆæ¯”å¦‚ç”¨ Python åšï¼‰å—ï¼Ÿå¯ä»¥æ›´ç›´è§‚ç†è§£æ€Žä¹ˆæŽ¨å¯¼å¯†é’¥ã€‚

![image-20250722224951092](READEME.assets/image-20250722224951092.png)

è¿™æ˜¯ä¸€ä¸ªå…³äºŽ **å…¬å…±å¯†é’¥åŠ å¯†ç³»ç»Ÿè®¾è®¡æ¼æ´žåˆ†æž** çš„é¢˜ç›®ã€‚ä½ éœ€è¦è¯†åˆ« Bob è®¾è®¡ä¸­ **4 ä¸ªå®‰å…¨æ¼æ´ž**ï¼Œå¹¶è§£é‡Š**æ”»å‡»è€…å¦‚ä½•åˆ©ç”¨æ¯ä¸ªæ¼æ´ž**ã€‚é¢˜ç›®èƒŒæ™¯åŸºäºŽ **RSA åŠ å¯† å’Œ HSMï¼ˆç¡¬ä»¶å®‰å…¨æ¨¡å—ï¼‰**ã€‚

------

## âœ… ä¸­æ–‡ç¿»è¯‘ï¼š

> Bob æ˜¯ä¸€åè½¯ä»¶å·¥ç¨‹å¸ˆï¼Œä»–è¦ä¸ºå…¬å¸å‘˜å·¥å®žçŽ°ä¸€ä¸ªå…¬é’¥åŠ å¯†ç³»ç»Ÿã€‚ä»–ä½¿ç”¨ RSA æ–¹æ¡ˆï¼Œå¹¶ä½¿ç”¨ HSM åšå¯†é’¥ç®¡ç†ã€‚
>
> - ä»–åœ¨ä¸»æœºä¸Šç”Ÿæˆ RSA æ¨¡æ•° n=pÃ—qn = p \times qï¼Œå¹¶æŠŠç´ æ•° p,qp, q ä¿å­˜åœ¨ HSM ä¸­ã€‚
> - ç„¶åŽä»–ä¸ºæ¯ä½å‘˜å·¥åœ¨ä¸€å°è®¡ç®—æœºä¸Šç”Ÿæˆä¸€å¯¹å…¬ç§é’¥ (e,d)(e, d)ï¼Œå¹¶é€šè¿‡å…¬å¸å†…éƒ¨ç½‘ç»œåˆ†å‘ç§é’¥ã€‚

ä½ çš„ä»»åŠ¡æ˜¯ï¼š
 åˆ—å‡ºè¿™ä¸ªè®¾è®¡ä¸­çš„ **4 ä¸ªå®‰å…¨æ¼æ´ž**ï¼Œå¹¶ç®€è¦è¯´æ˜Žæ”»å‡»è€…å¦‚ä½•åˆ©ç”¨è¿™äº›æ¼æ´žã€‚
 ã€8 åˆ† â†’ æ¯ä¸ªæ¼æ´ž+æ”»å‡»æ–¹å¼ = 2 åˆ†ã€‘

------

## âœ… æ ‡å‡†ç­”æ¡ˆï¼ˆå…±4ç‚¹ï¼‰ï¼š

------

### **æ¼æ´ž 1ï¼šRSAå¯†é’¥ç”Ÿæˆåœ¨ä¸å—ä¿æŠ¤çš„ä¸»æœºä¸Š**

- **é—®é¢˜**ï¼šåœ¨ä¸»æœºä¸Šç”Ÿæˆæ¨¡æ•° n=pÃ—qn = p \times qï¼Œp å’Œ q å¯èƒ½åœ¨å†…å­˜ä¸­æš‚æ—¶æš´éœ²ã€‚
- **æ”»å‡»æ–¹å¼**ï¼šæ”»å‡»è€…å¯ä»¥é€šè¿‡æ¶æ„è½¯ä»¶ã€ç¼“å­˜åˆ†æžã€å†…å­˜è½¬å‚¨ç­‰æ–¹å¼æå– p å’Œ qï¼Œè¿›è€Œ**å®Œå…¨ç ´è§£ RSA ç§é’¥**ã€‚

------

### **æ¼æ´ž 2ï¼šæ¯ä¸ªå‘˜å·¥çš„ç§é’¥åœ¨åŒä¸€å°æœºå™¨ä¸Šç”Ÿæˆ**

- **é—®é¢˜**ï¼šé›†ä¸­ç”Ÿæˆæ‰€æœ‰å‘˜å·¥çš„å¯†é’¥æ„å‘³ç€**å•ç‚¹å¤±è´¥ï¼ˆsingle point of failureï¼‰**ã€‚
- **æ”»å‡»æ–¹å¼**ï¼šå¦‚æžœæ”»å‡»è€…æŽ§åˆ¶è¿™å°æœºå™¨ï¼Œå°±å¯ä»¥**èŽ·å–æ‰€æœ‰å‘˜å·¥çš„ç§é’¥**ï¼Œä»Žè€Œ**è§£å¯†æ‰€æœ‰é€šä¿¡**ã€‚

------

### **æ¼æ´ž 3ï¼šç§é’¥é€šè¿‡å…¬å¸å†…ç½‘åˆ†å‘**

- **é—®é¢˜**ï¼šç§é’¥åœ¨ç½‘ç»œä¸­ä¼ è¾“ï¼Œå³ä½¿åœ¨å†…ç½‘ä¸­ä¹Ÿå®¹æ˜“å—åˆ°ä¸­é—´äººæ”»å‡»ã€‚

- **æ”»å‡»æ–¹å¼**ï¼šæ”»å‡»è€…å¯ä»¥é€šè¿‡ ARP æ¬ºéª—ã€ç½‘ç»œå—…æŽ¢ç­‰æ–¹å¼**æ‹¦æˆªå¯†é’¥åˆ†å‘æ•°æ®åŒ…**ï¼Œç›—å–ç§é’¥ã€‚

- > ### **ARP æ¬ºéª—ï¼ˆARP Spoofingï¼‰**
  >
  > - **å®šä¹‰**ï¼šARP æ¬ºéª—æ˜¯ä¸€ç§ç½‘ç»œæ”»å‡»æ‰‹æ®µï¼Œæ”»å‡»è€…ä¼ªè£…æˆç½‘ç»œä¸­çš„åˆæ³•è®¾å¤‡ï¼Œé€šè¿‡å‘é€ä¼ªé€ çš„ ARPï¼ˆåœ°å€è§£æžåè®®ï¼‰æ¶ˆæ¯ï¼Œå°†è‡ªå·±çš„ MAC åœ°å€ä¸Žç›®æ ‡è®¾å¤‡çš„ IP åœ°å€ç»‘å®šï¼Œä»Žè€ŒåŠ«æŒç½‘ç»œæµé‡ã€‚
  > - **æ”»å‡»æ–¹å¼**ï¼šé€šè¿‡ ARP æ¬ºéª—ï¼Œæ”»å‡»è€…å¯ä»¥ä½¿å¾—æ•°æ®åŒ…é€šè¿‡å…¶è®¡ç®—æœºè¿›è¡Œä¸­è½¬ï¼Œçªƒå–æˆ–è€…ä¿®æ”¹ä¼ è¾“çš„æ•°æ®ã€‚ä¾‹å¦‚ï¼Œæ”»å‡»è€…ä¼ªè£…æˆç›®æ ‡æœåŠ¡å™¨æˆ–è·¯ç”±å™¨ï¼Œä»Žè€Œåœ¨æ•°æ®ä¼ è¾“è¿‡ç¨‹ä¸­çªƒå–ç§é’¥ã€‚
  >
  > ### **ç½‘ç»œå—…æŽ¢ï¼ˆPacket Sniffingï¼‰**
  >
  > - **å®šä¹‰**ï¼šç½‘ç»œå—…æŽ¢æ˜¯ä¸€ç§é€šè¿‡ç›‘å¬å’Œæ•èŽ·ç½‘ç»œä¸ŠæœªåŠ å¯†çš„é€šä¿¡æ•°æ®åŒ…çš„æŠ€æœ¯ï¼Œæ”»å‡»è€…å¯ä»¥è¯»å–ç»è¿‡ç½‘ç»œä¼ è¾“çš„æ•æ„Ÿä¿¡æ¯ã€‚
  > - **æ”»å‡»æ–¹å¼**ï¼šæ”»å‡»è€…ä½¿ç”¨å—…æŽ¢å·¥å…·ï¼ˆå¦‚ Wiresharkï¼‰åœ¨ç½‘ç»œä¸­æ•æ‰æ•°æ®åŒ…ï¼Œå¦‚æžœé€šä¿¡æ²¡æœ‰åŠ å¯†æˆ–åŠ å¯†å¼±ï¼Œæ”»å‡»è€…å°±å¯ä»¥èŽ·å–åŒ…æ‹¬ç§é’¥åœ¨å†…çš„æ•æ„Ÿæ•°æ®ã€‚è¿™äº›ä¿¡æ¯å¯ä»¥è¢«ç”¨äºŽåŽç»­çš„æ”»å‡»ã€‚
  >
  > è¿™ä¸¤ç§æ”»å‡»æ–¹å¼éƒ½å¯ä»¥é€šè¿‡ç›‘å¬æˆ–ä¼ªè£…é€šä¿¡è·¯å¾„æ¥çªƒå–æ•æ„Ÿä¿¡æ¯ï¼Œç‰¹åˆ«æ˜¯ç§é’¥ï¼Œä¸¥é‡å¨èƒç½‘ç»œå®‰å…¨ã€‚

------

### **æ¼æ´ž 4ï¼šæ¯ä¸ªå‘˜å·¥éƒ½æœ‰è‡ªå·±çš„ RSA å¯†é’¥å¯¹**

- **é—®é¢˜**ï¼šè¿™ä½¿å¾—**å¯†é’¥ç®¡ç†æˆæœ¬éžå¸¸é«˜**ï¼Œä¹Ÿä¼šå¢žåŠ äººä¸ºå¤±è¯¯å’Œå¯†é’¥æ³„éœ²çš„é£Žé™©ã€‚
- **æ”»å‡»æ–¹å¼**ï¼šæ”»å‡»è€…åªè¦æ”»å‡»ä¸€ä¸ªå¼±ç”¨æˆ·ï¼ˆä¾‹å¦‚å¯†é’¥å¤‡ä»½ä¿å­˜åœ¨ä¸å®‰å…¨çš„åœ°æ–¹ï¼‰ï¼Œå°±å¯ä»¥**ç ´åæ•´ä¸ªç³»ç»Ÿä¿¡ä»»é“¾**ã€‚

------

## âœ… æ€»ç»“æ¨¡æ¿ï¼ˆè€ƒè¯•å†™ä½œå»ºè®®ï¼‰ï¼š

| Weakness                                        | Explanation                        | How an attacker can exploit it                   |
| ----------------------------------------------- | ---------------------------------- | ------------------------------------------------ |
| 1. Key generation on insecure host              | p and q are exposed in RAM         | Malware or RAM dump to recover RSA private key   |
| 2. Centralized key generation for all employees | Single point of failure            | Compromise the machine to steal all private keys |
| 3. Private key distributed via internal network | Keys in transit can be intercepted | ARP spoofing or sniffing to steal keys           |
| 4. One RSA key pair per employee                | Too many keys to manage securely   | Attack weakest endpoint to compromise the system |

------

#  **PPT æ–‡ä»¶å**: `18 crypto_-_public_key_encryption.pdf` 3é¡µ

![image-20250722225207258](READEME.assets/image-20250722225207258.png)

è¿™é¡µè®²çš„æ˜¯ **å…¬é’¥åŠ å¯†ï¼ˆPublic Key Encryptionï¼‰** çš„åŸºæœ¬åŽŸç†ï¼Œä¸‹é¢æ˜¯è¯¦ç»†è§£é‡Šï¼š

------

### ðŸ“Œ å›¾è§£å«ä¹‰ï¼ˆé…åˆä¸‹æ–¹æ–‡å­—ï¼‰

- å·¦è¾¹æ˜¯ **Aliceï¼ˆå‘é€è€…ï¼‰**ï¼Œå³è¾¹æ˜¯ **Bobï¼ˆæŽ¥æ”¶è€…ï¼‰**
- åŠ å¯†å‡½æ•° `E` å’Œè§£å¯†å‡½æ•° `D` åˆ†åˆ«ç”¨äºŽåŠ å¯†å’Œè§£å¯†
- `m` æ˜¯æ˜Žæ–‡ï¼ˆmessageï¼‰ï¼Œ`c` æ˜¯å¯†æ–‡ï¼ˆciphertextï¼‰
- `pk` æ˜¯å…¬é’¥ï¼ˆpublic keyï¼‰ï¼Œ`sk` æ˜¯ç§é’¥ï¼ˆsecret/private keyï¼‰

------

### ðŸ” åŠ å¯†æµç¨‹è¯´æ˜Ž

1. **Bob ç”Ÿæˆå¯†é’¥å¯¹**ï¼š

   - Bob ç”Ÿæˆä¸€å¯¹å¯†é’¥ï¼šå…¬é’¥ `PK` å’Œç§é’¥ `SK`
   - å…¬é’¥ `PK` æ˜¯å¯ä»¥å…¬å¼€çš„ï¼Œä»»ä½•äººéƒ½å¯ä»¥ä½¿ç”¨
   - ç§é’¥ `SK` æ˜¯ä¿å¯†çš„ï¼Œä»… Bob è‡ªå·±æ‹¥æœ‰

2. **Bob å°†å…¬é’¥å‘ç»™ Alice**ï¼š

   - Alice æ”¶åˆ° `PK` åŽï¼Œå°±å¯ä»¥åŠ å¯†å¥¹æƒ³è¦å‘é€ç»™ Bob çš„æ¶ˆæ¯ `m`

3. **Alice ä½¿ç”¨å…¬é’¥åŠ å¯†æ¶ˆæ¯**ï¼š

   - å¥¹ç”¨å…¬é’¥ `PK` å’ŒåŠ å¯†ç®—æ³• `E`ï¼Œå°†æ¶ˆæ¯ `m` åŠ å¯†æˆå¯†æ–‡ `c`

     ```
     c = E(PK, m)
     ```

4. **Bob ä½¿ç”¨ç§é’¥è§£å¯†å¯†æ–‡**ï¼š

   - Bob æ”¶åˆ°å¯†æ–‡ `c` åŽï¼Œä½¿ç”¨ç§é’¥ `SK` å’Œè§£å¯†ç®—æ³• `D` å°†å…¶è¿˜åŽŸä¸ºåŽŸå§‹æ¶ˆæ¯ `m`ï¼š

     ```
     m = D(SK, c)
     ```

------

### âœ… æ€»ç»“æ¦‚å¿µ

| è§’è‰²  | æ‹¥æœ‰çš„å¯†é’¥ | æ“ä½œ     | ç»“æžœ         |
| ----- | ---------- | -------- | ------------ |
| Alice | å…¬é’¥ `PK`  | åŠ å¯†æ¶ˆæ¯ | å¾—åˆ°å¯†æ–‡ `c` |
| Bob   | ç§é’¥ `SK`  | è§£å¯†å¯†æ–‡ | å¾—åˆ°åŽŸæ–‡ `m` |

------

### ðŸ“æ ¸å¿ƒæ€æƒ³

- å…¬é’¥åŠ å¯†çš„ä¼˜åŠ¿åœ¨äºŽ**å³ä½¿æ”»å‡»è€…æ‹¿åˆ°å…¬é’¥ï¼Œä¹Ÿæ— æ³•è½»æ˜“è§£å¯†å¯†æ–‡**
- **åªæœ‰æŒæœ‰ç§é’¥çš„æŽ¥æ”¶è€… Bob æ‰èƒ½è§£å¯†**ï¼Œç¡®ä¿é€šä¿¡å®‰å…¨

éœ€è¦æˆ‘è§£é‡Šå®ƒå’Œ RSA çš„å…³ç³»ï¼Œæˆ–åœ¨è€ƒè¯•é‡Œå¦‚ä½•ç­”è¿™ç±»é¢˜å—ï¼Ÿ

![image-20250722225510592](READEME.assets/image-20250722225510592.png)

è¿™é¡µæ˜¯å¯¹**å…¬é’¥åŠ å¯†ç³»ç»Ÿï¼ˆPublic Key Encryption Systemï¼‰**çš„å½¢å¼åŒ–å®šä¹‰ã€‚æˆ‘ä»¬é€è¡Œè¯¦ç»†è§£é‡Šï¼š

------

### ðŸ”‘ å®šä¹‰ï¼šä¸€ä¸ªå…¬é’¥åŠ å¯†ç³»ç»Ÿç”±ä¸‰ä¸ªç®—æ³•ç»„æˆï¼š

#### 1. **G()** â€” å¯†é’¥ç”Ÿæˆç®—æ³•ï¼ˆKey Generationï¼‰

- æ˜¯ä¸€ä¸ª**éšæœºç®—æ³•ï¼ˆrandomised algorithmï¼‰**
- å®ƒä¼šè¾“å‡ºä¸€å¯¹å¯†é’¥ï¼š`(pk, sk)`
  - `pk`: å…¬é’¥ï¼ˆpublic keyï¼‰
  - `sk`: ç§é’¥ï¼ˆsecret/private keyï¼‰

âœ… è¿™ä¸€æ­¥é€šå¸¸ç”±æŽ¥æ”¶è€…ï¼ˆå¦‚ Bobï¼‰æ¥å®Œæˆã€‚

------

#### 2. **E(pk, m)** â€” åŠ å¯†ç®—æ³•ï¼ˆEncryptionï¼‰

- æ˜¯ä¸€ä¸ª**éšæœºç®—æ³•**
- è¾“å…¥ï¼š`pk`ï¼ˆå…¬é’¥ï¼‰ï¼Œ`m`ï¼ˆæ˜Žæ–‡ï¼‰å±žäºŽæ¶ˆæ¯ç©ºé—´ `M`
- è¾“å‡ºï¼š`c`ï¼ˆå¯†æ–‡ï¼‰å±žäºŽå¯†æ–‡ç©ºé—´ `C`

âœ… å‘é€è€…ï¼ˆå¦‚ Aliceï¼‰ä½¿ç”¨ `pk` å’Œæ˜Žæ–‡ `m`ï¼Œç”Ÿæˆå¯†æ–‡ `c`

------

#### 3. **D(sk, c)** â€” è§£å¯†ç®—æ³•ï¼ˆDecryptionï¼‰

- æ˜¯ä¸€ä¸ªç¡®å®šæ€§ç®—æ³•ï¼ˆä¸æ˜¯éšæœºçš„ï¼‰
- è¾“å…¥ï¼š`sk`ï¼ˆç§é’¥ï¼‰ï¼Œ`c`ï¼ˆå¯†æ–‡ï¼‰å±žäºŽ `C`
- è¾“å‡ºï¼š`m`ï¼ˆæ˜Žæ–‡ï¼‰å±žäºŽ `M`ï¼Œæˆ–è€… `âŠ¥` è¡¨ç¤ºâ€œè§£å¯†å¤±è´¥â€æˆ–â€œæ— æ•ˆå¯†æ–‡â€

âœ… æŽ¥æ”¶è€…ï¼ˆå¦‚ Bobï¼‰ä½¿ç”¨ `sk` å’Œæ”¶åˆ°çš„ `c`ï¼Œæ¢å¤åŽŸå§‹æ¶ˆæ¯ `m`

------

### âœ… ä¸€è‡´æ€§è¦æ±‚ï¼ˆConsistencyï¼‰

è¿™ä¸€éƒ¨åˆ†æ˜¯æ•´ä¸ªå®šä¹‰çš„æ ¸å¿ƒï¼Œç¡®ä¿ç³»ç»Ÿæœ‰æ•ˆå¯ç”¨ï¼š

> å¯¹æ‰€æœ‰é€šè¿‡ `G()` ç”Ÿæˆçš„å¯†é’¥å¯¹ `(pk, sk)`ï¼Œä»¥åŠæ‰€æœ‰å¯èƒ½çš„æ˜Žæ–‡ `m âˆˆ M`ï¼Œéƒ½åº”è¯¥æœ‰ï¼š
>
> ```
> D(sk, E(pk, m)) = m
> ```

ä¹Ÿå°±æ˜¯è¯´ï¼š

- å…ˆç”¨å…¬é’¥åŠ å¯†ï¼Œå†ç”¨ç§é’¥è§£å¯†
- **ä¸€å®šèƒ½è¿˜åŽŸå‡ºåŽŸå§‹æ˜Žæ–‡ m**

------

### ðŸ§  æ€»ç»“ï¼ˆé€šä¿—ç†è§£ï¼‰

| æ­¥éª¤ | ä½œç”¨     | è°æ“ä½œ          | ç”¨åˆ°çš„é”®   |
| ---- | -------- | --------------- | ---------- |
| G()  | ç”Ÿæˆå¯†é’¥ | æŽ¥æ”¶è€…ï¼ˆBobï¼‰   | `(pk, sk)` |
| E()  | åŠ å¯†æ¶ˆæ¯ | å‘é€è€…ï¼ˆAliceï¼‰ | ä½¿ç”¨ `pk`  |
| D()  | è§£å¯†å¯†æ–‡ | æŽ¥æ”¶è€…ï¼ˆBobï¼‰   | ä½¿ç”¨ `sk`  |

ä¸€è‡´æ€§æ˜¯æ•´ä¸ªåŠ å¯†ç³»ç»Ÿçš„**æ­£ç¡®æ€§ä¿éšœ**ã€‚

------

## **å…¬é’¥ä¸èƒ½ç”¨æ¥è§£å¯†**ï¼Œå…¶**å®‰å…¨æ€§**ç¡®å®ž**ä¾èµ–äºŽæ•°å­¦éš¾é¢˜**ï¼Œæ¯”å¦‚ï¼š

### ðŸ‘‰ åœ¨ **RSA å…¬é’¥åŠ å¯†** ä¸­ï¼Œå®‰å…¨æ€§åŸºäºŽï¼š

> **å¤§æ•°å› å¼åˆ†è§£å›°éš¾æ€§é—®é¢˜ï¼ˆInteger Factorization Problemï¼‰**

![image-20250722230544335](READEME.assets/image-20250722230544335.png)

è¿™å¼ å¹»ç¯ç‰‡è®²çš„æ˜¯ **RSA å…¬é’¥åŠ å¯†ç®—æ³•** çš„èµ·æºä¸Žåº”ç”¨ã€‚

------

## âœ… é€è¡Œè¯¦ç»†è§£é‡Šï¼š

### **æ ‡é¢˜ï¼šRSA**

è¿™æ˜¯æŒ‡ RSA åŠ å¯†ç®—æ³•ï¼Œå…¨ç§°æ˜¯ï¼š

> **Rivestâ€“Shamirâ€“Adleman** åŠ å¯†ç®—æ³•

------

### **Invented in 1977ï¼ˆ1977å¹´å‘æ˜Žï¼‰**

RSA æ˜¯åœ¨ 1977 å¹´ç”±ä¸‰ä½å­¦è€…æå‡ºçš„ï¼Œæ˜¯ä¸–ç•Œä¸Šç¬¬ä¸€ä¸ªçœŸæ­£å¹¿æ³›ä½¿ç”¨çš„**éžå¯¹ç§°åŠ å¯†ç®—æ³•**ï¼ˆå³å…¬é’¥åŠ å¯†ï¼‰ã€‚

------

### **By Ron Rivest, Adi Shamir, Leonard Adleman**

è¿™ä¸‰ä½ MIT çš„ç§‘å­¦å®¶æ˜¯ RSA ç®—æ³•çš„å‘æ˜Žäººï¼Œä»–ä»¬ç”¨è‡ªå·±çš„å§“æ°é¦–å­—æ¯æ¥å‘½åç®—æ³•ï¼š

- R = Rivest
- S = Shamir
- A = Adleman

å³ä¸‹è§’çš„ç…§ç‰‡å°±æ˜¯è¿™ä¸‰ä½å‘æ˜Žäººã€‚

------

### **The first widely used public key system**

æ„æ€æ˜¯ï¼š**RSA æ˜¯ç¬¬ä¸€ä¸ªè¢«å¹¿æ³›åº”ç”¨çš„å…¬é’¥åŠ å¯†ç³»ç»Ÿ**ï¼Œå®ƒæ”¹å˜äº†å¯†ç å­¦çš„æ ¼å±€ï¼š

#### å®ƒåº”ç”¨äºŽï¼š

- **SSL/TLS åè®®**ï¼šç”¨äºŽç½‘é¡µåŠ å¯†ä¼ è¾“ï¼ˆhttpsï¼‰
  - TLS 1.2 å’Œ TLS 1.3 éƒ½æ”¯æŒ/å…¼å®¹ RSAï¼ˆè™½ç„¶ TLS 1.3 æ›´å¸¸ç”¨æ¤­åœ†æ›²çº¿åŠ å¯†ï¼‰
- **Secure email and file systems**ï¼šå¦‚ PGP åŠ å¯†é‚®ä»¶ã€åŠ å¯†ç¡¬ç›˜ç­‰
- **many others**ï¼šæ¯”å¦‚æ•°å­—ç­¾åã€è½¯ä»¶æ›´æ–°éªŒè¯ã€å®‰å…¨ç™»å½•ã€VPN ç­‰

------

## ðŸ§  å°æ€»ç»“ï¼š

| å†…å®¹     | è¯´æ˜Ž                                      |
| -------- | ----------------------------------------- |
| ç®—æ³•åç§° | RSA                                       |
| å‘æ˜Žäºº   | Ron Rivestã€Adi Shamirã€Leonard Adleman   |
| å‘æ˜Žæ—¶é—´ | 1977 å¹´                                   |
| å±žäºŽ     | å…¬é’¥åŠ å¯† / éžå¯¹ç§°åŠ å¯†                     |
| åº”ç”¨åœºæ™¯ | SSL/TLSï¼ˆç½‘ç»œå®‰å…¨ï¼‰ã€åŠ å¯†é‚®ä»¶ã€æ•°å­—ç­¾åç­‰ |

RSA çš„æ ¸å¿ƒæ•°å­¦åŸºç¡€æ˜¯ï¼š

> ä½¿ç”¨ä¸¤ä¸ªå¤§è´¨æ•°ç›¸ä¹˜å¾—åˆ°ä¸€ä¸ªå¤§æ•° `n`ï¼Œåè¿‡æ¥ä»Ž `n` æŽ¨å‡ºé‚£ä¸¤ä¸ªè´¨æ•° `p, q` æ˜¯éžå¸¸éš¾çš„ï¼ˆå³å› å¼åˆ†è§£å›°éš¾ï¼‰
>  æ‰€ä»¥åŠ å¯†å®¹æ˜“ï¼Œè§£å¯†å¿…é¡»æŽŒæ¡ç§é’¥

------

å¦‚éœ€æˆ‘ç”¨å›¾ç¤ºå¸®ä½ è¡¥å……æ•´ä¸ª RSA å·¥ä½œæµç¨‹ï¼Œæˆ‘å¯ä»¥ç»§ç»­å±•å¼€ã€‚

![image-20250722230647607](READEME.assets/image-20250722230647607.png)

è¿™å¼ å¹»ç¯ç‰‡ç”¨ä¸€ä¸ªâ€œé”å’Œé’¥åŒ™â€çš„ç±»æ¯”æ¥è§£é‡Š **å…¬é’¥åŠ å¯†ï¼ˆPublic Key Encryptionï¼‰** çš„æ ¸å¿ƒæ€æƒ³ï¼Œç›®çš„æ˜¯è®©äººä»¬ç›´è§‚ç†è§£å®ƒçš„ä¼Ÿå¤§ä¹‹å¤„ã€‚

------

## ðŸ” æ ‡é¢˜ï¼š**How great was this invention?ï¼ˆè¿™é¡¹å‘æ˜Žæœ‰å¤šä¼Ÿå¤§ï¼Ÿï¼‰**

å®ƒè¯•å›¾è¡¨è¾¾ï¼š

> å…¬é’¥åŠ å¯†å°±åƒæ˜¯ä¸€ç§é¢ è¦†å¸¸è¯†çš„â€œç¥žå¥‡é”â€ï¼Œ**ç”¨ä¸€æŠŠé’¥åŒ™é”ä¸Šï¼Œå´åªèƒ½ç”¨å¦ä¸€æŠŠé’¥åŒ™è§£å¼€**ï¼Œè€Œä¸”**ä½ æ— æ³•ä»Žå·²çŸ¥é’¥åŒ™æˆ–é”æŽ¨å‡ºå¦ä¸€æŠŠé’¥åŒ™**ã€‚

------

### âœ… é€æ¡è§£é‡Šï¼š

#### **1. One key to lock it, and \*another key\* to unlock it**

- è¿™ä»£è¡¨ï¼š

  - **åŠ å¯†ï¼ˆé”ï¼‰ç”¨å…¬é’¥ï¼ˆPublic Keyï¼‰**
  - **è§£å¯†ï¼ˆå¼€é”ï¼‰ç”¨ç§é’¥ï¼ˆPrivate Keyï¼‰**

- ä¹Ÿå°±æ˜¯è¯´ï¼š

  > åŠ å¯†å’Œè§£å¯†ä¸æ˜¯åŒä¸€æŠŠé’¥åŒ™ï¼Œè€Œæ˜¯**ä¸€å¯¹å¯†é’¥**ï¼Œè¿™ä¸ªç‰¹æ€§å«åšï¼š**éžå¯¹ç§°åŠ å¯†**

------

#### **2. Given the lock and one of the keys, \*you are unable to manufacture the second key\***

- è¿™å°±æ˜¯å…¬é’¥åŠ å¯†å®‰å…¨æ€§çš„æ ¹åŸºï¼š

  - å³ä½¿ä½ **çŸ¥é“äº†å…¬é’¥**ï¼ˆæˆ–å…¬å¼€çš„åŠ å¯†æ–¹æ³•ï¼‰
  - ä¹Ÿ**æ— æ³•é€†æŽ¨å‡ºç§é’¥**

- æ•°å­¦ä¸Šï¼Œè¿™ä¾èµ–äºŽï¼š

  - **å¤§æ•´æ•°å› å¼åˆ†è§£éš¾é¢˜**ï¼ˆRSAï¼‰
  - æˆ– **ç¦»æ•£å¯¹æ•°é—®é¢˜**ï¼ˆå¦‚ ElGamalã€ECCï¼‰

- æ‰€ä»¥ï¼š

  > æ‹¿åˆ°å…¬é’¥å°±ç®—ä½ èƒ½åŠ å¯†ï¼Œä½†**ä½ æ— æ³•åæŽ¨å‡ºç§é’¥ï¼Œä¹Ÿå°±æ— æ³•è§£å¯†**

------

### ðŸ’¡ æ€»ç»“ï¼ˆé€šä¿—ç±»æ¯”ï¼‰ï¼š

æƒ³è±¡ä½ è®¾è®¡äº†ä¸€ä¸ªé”ï¼ˆåŠ å¯†ç®—æ³•ï¼‰ï¼Œ
 åˆ«äººå¯ä»¥ç”¨ä½ æä¾›çš„é’¥åŒ™ï¼ˆå…¬é’¥ï¼‰æ¥**ä¸Šé”**ï¼Œ
 ä½†**åªæœ‰ä½ **æœ‰**é‚£æŠŠç§é’¥**èƒ½å¼€é”ï¼Œ
 è€Œä»–ä»¬**æ ¹æœ¬é€ ä¸å‡ºå¦ä¸€æŠŠé’¥åŒ™**æ¥å¼€è¿™ä¸ªé”â€”â€”
 è¿™å°±æ˜¯**å…¬é’¥åŠ å¯†çš„é­”åŠ›**ï¼

------

éœ€è¦æˆ‘æŠŠè¿™ç±»æ¯”å»¶ä¼¸æˆå›¾è§£æˆ–è¡¥å……å…¬å¼åŽŸç†ï¼Œä¹Ÿå¯ä»¥ç»§ç»­å‘Šè¯‰æˆ‘ã€‚

![image-20250722230740418](READEME.assets/image-20250722230740418.png)

è¿™å¼ å¹»ç¯ç‰‡è§£é‡Šäº†åŠ å¯†å­¦ä¸­çš„ä¸€ä¸ªæ ¸å¿ƒæ¦‚å¿µï¼š**å•å‘å‡½æ•°ï¼ˆOne-way functionï¼‰**ï¼Œå®ƒæ˜¯çŽ°ä»£åŠ å¯†ç³»ç»Ÿï¼ˆæ¯”å¦‚ Diffie-Hellman åè®® å’Œ RSAï¼‰çš„åŸºç¡€ã€‚

------

## ðŸ”‘ æ ‡é¢˜ï¼š**One-way functionï¼ˆå•å‘å‡½æ•°ï¼‰**

ä¸€ä¸ªå•å‘å‡½æ•°å…·å¤‡ä¸¤ä¸ªç‰¹å¾ï¼š

1. **æ­£å‘è®¡ç®—å®¹æ˜“**ï¼ˆeasy to computeï¼‰
2. **åå‘è®¡ç®—å›°éš¾**ï¼ˆhard to invertï¼‰

------

- ![image-20250722230916472](READEME.assets/image-20250722230916472.png)

> å…¬å¼ `y = g^x mod p` ä»£è¡¨çš„æ˜¯ **æ¨¡å¹‚è¿ç®—**ï¼Œå…·ä½“å«ä¹‰å¦‚ä¸‹ï¼š
>
> 1. **g**ï¼šè¿™æ˜¯ä¸€ä¸ªå›ºå®šçš„åŸºæ•°ï¼ˆé€šå¸¸ä¸ºä¸€ä¸ªå°çš„æ•´æ•°ï¼‰ï¼Œåœ¨Diffie-Hellmanåè®®ä¸­ï¼Œ`g` æ˜¯å…¬å¼€çš„ï¼Œæ‰€æœ‰å‚ä¸Žè€…éƒ½çŸ¥é“å®ƒã€‚
> 2. **x**ï¼šè¿™æ˜¯ä¸€ä¸ªç§˜å¯†çš„æ•´æ•°ï¼Œé€šå¸¸ç§°ä¸º**ç§é’¥**ã€‚æ¯ä¸ªå‚ä¸Žè€…éƒ½æœ‰ä¸€ä¸ªç§é’¥ï¼Œ`x` æ˜¯ç§é’¥çš„è¡¨ç¤ºã€‚
> 3. **p**ï¼šè¿™æ˜¯ä¸€ä¸ªå¤§ç´ æ•°ï¼Œä¹Ÿé€šå¸¸æ˜¯å…¬å¼€çš„ã€‚åœ¨Diffie-Hellmanåè®®ä¸­ï¼Œ`p` ä¹Ÿæ˜¯å‚ä¸Žè€…ä¹‹é—´å…±äº«çš„ã€‚
> 4. **y**ï¼šè¿™æ˜¯é€šè¿‡æ¨¡å¹‚è¿ç®—å¾—å‡ºçš„ç»“æžœã€‚`y` æ˜¯å…¬å¼€çš„ï¼Œå¯ä»¥å®‰å…¨åœ°ä¼ è¾“ç»™å…¶ä»–å‚ä¸Žè€…ã€‚
>
> ### å…¬å¼çš„å«ä¹‰ï¼š
>
> - `g^x` æ˜¯æŒ‡å°†åŸºæ•° `g` æå‡åˆ° `x` æ¬¡æ–¹ã€‚
> - `mod p` è¡¨ç¤ºå–è¯¥ç»“æžœå¯¹ `p` å–æ¨¡ï¼Œå³å–ä½™æ•°ã€‚è¿™ä¸ªæ“ä½œçš„ç›®çš„æ˜¯ä½¿å¾—è®¡ç®—ç»“æžœä¸ä¼šè¿‡äºŽåºžå¤§ï¼Œä»Žè€Œä½¿è®¡ç®—å¯ä»¥åœ¨åˆç†èŒƒå›´å†…è¿›è¡Œã€‚
> - ![](READEME.assets/image-20250726182641418.png)

1. ![image-20250722230841382](READEME.assets/image-20250722230841382.png)

------

### ðŸ’¡ æ€»ç»“ï¼š

| åŠ å¯†æ–¹æ¡ˆ       | æ­£å‘æ“ä½œ            | åå‘æ“ä½œï¼ˆå›°éš¾ä¹‹å¤„ï¼‰       |
| -------------- | ------------------- | -------------------------- |
| Diffie-Hellman | gxmodâ€‰â€‰pg^x \mod p  | ç¦»æ•£å¯¹æ•°é—®é¢˜ï¼ˆæ±‚ xxï¼‰      |
| RSA            | n=pÃ—qn = p \times q | å› å¼åˆ†è§£é—®é¢˜ï¼ˆæ±‚ p,qp, qï¼‰ |

å› æ­¤ï¼Œ**å•å‘å‡½æ•°æ˜¯åŠ å¯†å®‰å…¨çš„æ ¸å¿ƒä¿éšœ**ï¼šè®©åŠ å¯†è¿‡ç¨‹ç®€å•ï¼Œä½†è§£å¯†åªèƒ½é ç‰¹å®šå¯†é’¥ï¼ˆè€Œä¸æ˜¯æš´åŠ›åæŽ¨ï¼‰ã€‚

------

éœ€è¦æˆ‘ç”¨æ›´ç”Ÿæ´»åŒ–çš„ä¾‹å­è§£é‡Šå•å‘å‡½æ•°ï¼Œä¹Ÿå¯ä»¥å‘Šè¯‰æˆ‘ï¼

![image-20250722231005890](READEME.assets/image-20250722231005890.png)

![image-20250722231111457](READEME.assets/image-20250722231111457.png)

![image-20250722231344691](READEME.assets/image-20250722231344691.png)

![image-20250722231352786](READEME.assets/image-20250722231352786.png)

![image-20250722231759920](READEME.assets/image-20250722231759920.png)

![image-20250722231829927](READEME.assets/image-20250722231829927.png)

![image-20250722231954655](READEME.assets/image-20250722231954655.png)

![image-20250722232507303](READEME.assets/image-20250722232507303.png)

![image-20250722232002032](READEME.assets/image-20250722232002032.png)

![image-20250722232013029](READEME.assets/image-20250722232013029.png)

![image-20250722232559657](READEME.assets/image-20250722232559657.png)

![image-20250722232651375](READEME.assets/image-20250722232651375.png)

![image-20250722232659219](READEME.assets/image-20250722232659219.png)

![image-20250722232706781](READEME.assets/image-20250722232706781.png)

![image-20250722232951708](READEME.assets/image-20250722232951708.png)

![image-20250722233138461](READEME.assets/image-20250722233138461.png)

![image-20250722233146732](READEME.assets/image-20250722233146732.png)

![image-20250722233159008](READEME.assets/image-20250722233159008.png)

![image-20250722233204706](READEME.assets/image-20250722233204706.png)

![image-20250726185338740](READEME.assets/image-20250726185338740.png)

è¿™å¼ å›¾ç‰‡ä»‹ç»çš„æ˜¯**æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼ˆExtended Euclidean Algorithmï¼‰\**çš„ä¸€ä¸ª\**ç‰¹åˆ«åº”ç”¨åœºæ™¯**ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬éžå¸¸å…³æ³¨çš„æƒ…å†µï¼š**ä¸¤ä¸ªæ•°äº’è´¨ï¼ˆæœ€å¤§å…¬çº¦æ•°ä¸º1ï¼‰æ—¶å¦‚ä½•æ‰¾åˆ°å®ƒä»¬çš„ä¹˜æ³•é€†å…ƒ**ã€‚

æˆ‘æ¥ä¸€æ­¥æ­¥è¯¦ç»†è§£é‡Šï¼š

------

### ðŸ“˜ ä»€ä¹ˆæ˜¯æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼Ÿ

è¿™æ˜¯ä¸€ä¸ªç®—æ³•ï¼Œç”¨æ¥è§£å†³ä¸‹åˆ—å½¢å¼çš„ç­‰å¼ï¼š

```
sa + bt = gcd(a, b)
```

å…¶ä¸­ï¼š

- `a` å’Œ `b` æ˜¯ä¸¤ä¸ªå·²çŸ¥æ•´æ•°ï¼Œ
- `s` å’Œ `t` æ˜¯æœªçŸ¥æ•´æ•°ï¼ˆæˆ‘ä»¬è¦æ‰¾çš„ï¼‰ï¼Œ
- `gcd(a, b)` æ˜¯ `a` å’Œ `b` çš„æœ€å¤§å…¬çº¦æ•°ã€‚

è¿™ä¸ªç®—æ³•çš„å¼ºå¤§ä¹‹å¤„åœ¨äºŽï¼š

> å®ƒä¸ä»…èƒ½ç®—å‡º `gcd(a, b)`ï¼Œè¿˜èƒ½æ‰¾å‡ºä¸€ç»„æ•´æ•° `s` å’Œ `t`ï¼Œä½¿å¾— `sa + bt = gcd(a, b)` æˆç«‹ã€‚

------

### ðŸ§© å›¾ç‰‡ä¸­è®²çš„â€œç‰¹åˆ«æƒ…å†µâ€æ˜¯ï¼š

æˆ‘ä»¬åªå…³æ³¨ `gcd(a, b) = 1` çš„æƒ…å†µï¼Œä¹Ÿå°±æ˜¯ï¼š

```
a å’Œ b äº’è´¨ï¼ˆæ²¡æœ‰å…¬å…±å› å­ï¼‰
```

äºŽæ˜¯å…¬å¼å˜æˆï¼š

```
sa + bt = 1
```

------

### ðŸ” è¿™ä¸ªå…¬å¼æ˜¯æ€Žä¹ˆæ¥çš„ï¼Ÿ

- å› ä¸º `gcd(a, b) = 1`ï¼Œæ‰€ä»¥ä¸€å®šå­˜åœ¨æ•´æ•° `s` å’Œ `t` ä½¿å¾—ï¼š

  ```
  sa + bt = 1
  ```

- æŠŠè¿™ä¸ªå¼å­å˜ä¸€ä¸‹ï¼š

  ```
  sa = 1 - bt
  ```

- é‚£ä¹ˆè¿™å°±è¯´æ˜Žï¼š

  ```
  sa â‰¡ 1 (mod b)
  ```

æ¢å¥è¯è¯´ï¼š**s å°±æ˜¯ a çš„æ¨¡ b çš„ä¹˜æ³•é€†å…ƒ**ï¼

------

### âœ… ä¸¾ä¸ªä¾‹å­å¸®ä½ ç†è§£ï¼š

è®¾ `a = 3`ï¼Œ`b = 7`ã€‚æˆ‘ä»¬å¸Œæœ›æ‰¾åˆ°æ•´æ•° `s`ï¼Œä½¿å¾—ï¼š

```
3 Ã— s â‰¡ 1 mod 7
```

ç”¨æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•å¯ä»¥æ±‚å¾—ï¼š

```
s = 5ï¼Œå› ä¸º 3 Ã— 5 = 15ï¼Œ15 mod 7 = 1
```

------

### ðŸ“Œ è¿™ä¸ªæœ‰ä»€ä¹ˆç”¨ï¼Ÿ

è¿™ä¸ªè¿ç®—å¹¿æ³›åº”ç”¨åœ¨å¯†ç å­¦ä¸­ï¼Œæ¯”å¦‚ï¼š

- **RSA ç®—æ³•**é‡Œï¼Œéœ€è¦æ±‚ `d = eâ»Â¹ mod Ï†(N)`ï¼Œå°±æ˜¯æ±‚ `e` åœ¨æ¨¡ `Ï†(N)` ä¸‹çš„é€†å…ƒï¼›
- è¿˜æœ‰åœ¨ **æ¨¡çº¿æ€§æ–¹ç¨‹æ±‚è§£**ã€**æ¤­åœ†æ›²çº¿å¯†ç ** ç­‰ä¸­ä¹Ÿéƒ½ç”¨åˆ°äº†æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•ã€‚

------

### âœ… æ€»ç»“ï¼š

| æœ¯è¯­                   | å«ä¹‰                                                         |
| ---------------------- | ------------------------------------------------------------ |
| `sa + bt = 1`          | è¯´æ˜Ž a å’Œ b æ˜¯äº’è´¨çš„                                         |
| `sa â‰¡ 1 mod b`         | è¯´æ˜Ž `s` æ˜¯ `a` åœ¨æ¨¡ `b` ä¸‹çš„ä¹˜æ³•é€†å…ƒ                        |
| æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•çš„ä½œç”¨ | ä¸ä»…èƒ½æ±‚æœ€å¤§å…¬çº¦æ•°ï¼Œè¿˜èƒ½æ‰¾å‡º `s` å’Œ `t` ä½¿å¾—è¿™ä¸ªç­‰å¼æˆç«‹ï¼Œä»Žè€Œæ‰¾å‡ºä¹˜æ³•é€†å…ƒ |

------

å¦‚æžœä½ æƒ³çœ‹è¿™ä¸ªç®—æ³•çš„**è®¡ç®—è¿‡ç¨‹å®žä¾‹**ï¼Œæˆ‘ä¹Ÿå¯ä»¥ä¸€æ­¥æ­¥æ¼”ç®—ç»™ä½ çœ‹ï¼æ˜¯å¦è¦æˆ‘æ¼”ç¤ºä¸€ä¸ªå®Œæ•´ä¾‹å­ï¼Ÿ

![image-20250727202935307](READEME.assets/image-20250727202935307.png)

è¿™å¼ å›¾ç‰‡è§£é‡Šäº†å¦‚ä½•**è®¡ç®—æ¨¡ N ä¸‹æŸä¸ªæ•´æ•° a çš„ä¹˜æ³•é€†å…ƒ**ï¼ˆä¹Ÿç§°æ¨¡åå…ƒç´ ï¼‰ï¼Œå…¶å†…å®¹å¦‚ä¸‹ï¼š

------

### âœ… ä¸­æ–‡ç¿»è¯‘ä¸Žè¯¦ç»†è§£é‡Šï¼š

#### ðŸ“Œ é—®é¢˜å®šä¹‰ï¼š

æˆ‘ä»¬ç»™å®šä¸€ä¸ªæ•´æ•° `a` å’Œä¸€ä¸ªæ¨¡æ•° `N`ï¼Œ**è¦æ±‚ a ä¸Ž N äº’è´¨**ï¼ˆå³ `gcd(a, N) = 1`ï¼‰ï¼Œæˆ‘ä»¬æƒ³æ±‚å‡ºä¸€ä¸ªæ•´æ•° `aâ»Â¹`ï¼Œä½¿å¾—ï¼š

> â€ƒâ€ƒ**a Ã— aâ»Â¹ â‰¡ 1 mod N**

ä¹Ÿå°±æ˜¯è¯´ï¼Œ`aâ»Â¹` æ˜¯ `a` åœ¨æ¨¡ `N` æ„ä¹‰ä¸‹çš„ä¹˜æ³•é€†å…ƒã€‚

------

#### ðŸ“Œ å¦‚ä½•è®¡ç®—ï¼Ÿï¼ˆæç¤ºï¼‰

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ **æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼ˆExtended Euclidean Algorithmï¼‰** æ¥æ±‚è§£ã€‚

æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•ä¸åªæ˜¯æ±‚æœ€å¤§å…¬çº¦æ•° `gcd(a, N)`ï¼Œå®ƒè¿˜ä¼šæ‰¾å‡ºä¸€ç»„æ•´æ•° `s` å’Œ `t`ï¼Œæ»¡è¶³è¿™ä¸ªç­‰å¼ï¼š

> â€ƒâ€ƒ**s Ã— a + t Ã— N = gcd(a, N)**

å¦‚æžœ `a` ä¸Ž `N` äº’è´¨ï¼Œé‚£ä¹ˆ `gcd(a, N) = 1`ï¼Œä»£å…¥å¯å¾—ï¼š

> â€ƒâ€ƒ**s Ã— a + t Ã— N = 1**

æˆ‘ä»¬å¯ä»¥å¯¹è¿™ä¸ªç­‰å¼ä¸¤è¾¹åŒæ—¶å–æ¨¡ `N`ï¼Œå› ä¸º `t Ã— N â‰¡ 0 mod N`ï¼Œæ‰€ä»¥ï¼š

> â€ƒâ€ƒ**s Ã— a â‰¡ 1 mod N**

è¿™æ­£æ˜¯æˆ‘ä»¬æƒ³è¦çš„é€†å…ƒå®šä¹‰å¼ï¼æ‰€ä»¥ï¼Œ**`s` å°±æ˜¯ a åœ¨æ¨¡ N ä¸‹çš„é€†å…ƒ aâ»Â¹**ã€‚

------

### ðŸ§  ä¸¾ä¸ªä¾‹å­ï¼š

è®¾ `a = 3`ï¼Œ`N = 7`ï¼Œæˆ‘ä»¬æ±‚ `3â»Â¹ mod 7`ï¼š

1. ç”±äºŽ `gcd(3, 7) = 1`ï¼Œæ»¡è¶³äº’è´¨æ¡ä»¶ï¼›
2. ä½¿ç”¨æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ï¼š
    â€ƒ`1 = 5 Ã— 3 + (-2) Ã— 7`ï¼›
3. æ‰€ä»¥ï¼š`5 Ã— 3 â‰¡ 1 mod 7`ï¼Œå³ï¼š
    â€ƒ**3â»Â¹ â‰¡ 5 mod 7**

------

### âœ… æ€»ç»“ï¼š

- **é€†å…ƒçš„æœ¬è´¨**æ˜¯è§£å‡º `a Ã— x â‰¡ 1 mod N` ä¸­çš„ `x`ï¼›
- ä½¿ç”¨æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•å¯æœ‰æ•ˆæ±‚å‡º `s`ï¼Œä½¿å¾— `s Ã— a + t Ã— N = 1`ï¼›
- é‚£ä¹ˆè¿™ä¸ª `s` å³ä¸º `a` çš„æ¨¡é€†å…ƒ `aâ»Â¹`ï¼ˆæ¨¡ `N`ï¼‰ã€‚

å¦‚éœ€æˆ‘æ‰‹åŠ¨æ¼”ç¤ºä¸€æ¬¡æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•çš„è¿‡ç¨‹ï¼Œè¯·å‘Šè¯‰æˆ‘æ•°å€¼ï¼Œæˆ‘å¯ä»¥ä¸€æ­¥æ­¥å±•ç¤ºï¼

![image-20250727203348851](READEME.assets/image-20250727203348851.png)

è¿™å¼ å¹»ç¯ç‰‡æ€»ç»“äº†**åˆæ•°æ¨¡è¿ç®—ï¼ˆarithmetic mod compositesï¼‰**ä¸­çš„ä¸€äº›é‡è¦æ¦‚å¿µï¼Œç‰¹åˆ«æ˜¯åœ¨ RSA å’Œæ•°è®ºä¸­éžå¸¸å…³é”®ã€‚ä¸‹é¢æ˜¯è¯¦ç»†çš„ä¸­æ–‡è§£é‡Šï¼š

------

## âœ… å¹»ç¯ç‰‡æ ‡é¢˜ï¼š

**Summary: arithmetic mod composites**
 **åˆæ•°æ¨¡ä¸‹çš„ç®—æœ¯è¿ç®—æ€»ç»“**

------

## ðŸ“Œ ç¬¬ä¸€è¡Œï¼š

**Let N = p Ã— q where p, q are primes**
 ä»¤ N = p Ã— qï¼Œå…¶ä¸­ p å’Œ q æ˜¯è´¨æ•°ã€‚

> è¿™å¯¹åº”äºŽ RSA åŠ å¯†ä¸­æœ€å…³é”®çš„ä¸€æ­¥ï¼šæž„é€ ä¸€ä¸ªç”±ä¸¤ä¸ªè´¨æ•°ä¹˜ç§¯æž„æˆçš„æ¨¡æ•° Nã€‚

------

## ðŸ“Œ ç¬¬äºŒè¡Œï¼š

**ZN = {0, 1, 2, ..., Nâˆ’1}**

> è¡¨ç¤ºæ¨¡ N æ„ä¹‰ä¸‹çš„æ•´æ•°é›†åˆï¼Œä¹Ÿç§°ä¸ºæ¨¡çŽ¯ï¼ˆringï¼‰ï¼ŒåŒ…å«ä»Ž 0 åˆ° Nâˆ’1 çš„æ‰€æœ‰æ•´æ•°ã€‚

------

## ðŸ“Œ ç¬¬ä¸‰è¡Œï¼š

**ZN\* = {invertible elements in ZN}**

> è¡¨ç¤ºæ¨¡ N æ„ä¹‰ä¸‹çš„**å¯é€†å…ƒç´ é›†åˆ**ï¼Œä¹Ÿå°±æ˜¯æ‰€æœ‰ä¸Ž N äº’è´¨çš„æ•´æ•°çš„é›†åˆã€‚

ä¾‹å¦‚ï¼šå¦‚æžœ N = 15ï¼ŒZ15* = {1, 2, 4, 7, 8, 11, 13, 14}ï¼ˆè¿™äº›æ•°å’Œ 15 çš„æœ€å¤§å…¬çº¦æ•°éƒ½æ˜¯ 1ï¼‰ã€‚

------

## ðŸ“Œ Facts: ï¼ˆäº‹å®ž/å®šç†ï¼‰

### (1) x âˆˆ ZN is invertible âŸº gcd(x, N) = 1

> ä¸€ä¸ªæ•´æ•° x åœ¨æ¨¡ N ä¸‹å¯é€†ï¼Œå½“ä¸”ä»…å½“ **x ä¸Ž N äº’è´¨**ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼š

- è‹¥ `gcd(x, N) = 1`ï¼Œåˆ™å­˜åœ¨ xâˆ’1ï¼Œä½¿å¾—ï¼š

  > â€ƒâ€ƒx Ã— xâ»Â¹ â‰¡ 1 mod N

------

### (2) Number of elements in ZN* is Ï†(N) = (pâˆ’1)(qâˆ’1)

> åœ¨ ZN ä¸­ï¼Œæ»¡è¶³ä¸Ž N äº’è´¨çš„æ•°çš„ä¸ªæ•°ï¼Œå°±æ˜¯æ¬§æ‹‰å‡½æ•° Ï†(N)ã€‚

- è‹¥ N = p Ã— qï¼ˆp å’Œ q æ˜¯ä¸åŒè´¨æ•°ï¼‰ï¼Œé‚£ä¹ˆï¼š

  > â€ƒâ€ƒÏ†(N) = (pâˆ’1)(qâˆ’1)

è¿™ä¸ª Ï†(N) åœ¨ RSA ä¸­éžå¸¸é‡è¦ï¼Œå› ä¸ºç§é’¥ `d` æ˜¯åŸºäºŽ `eâ»Â¹ mod Ï†(N)` è®¡ç®—çš„ã€‚

------

## ðŸ“Œ Eulerâ€™s Theoremï¼ˆæ¬§æ‹‰å®šç†ï¼‰ï¼š

**å¯¹äºŽæ‰€æœ‰ a âˆˆ ZN\*ï¼šaÏ†(N) â‰¡ 1 mod N**

> æ¬§æ‹‰å®šç†è¯´æ˜Žäº†ï¼šåªè¦ a ä¸Ž N äº’è´¨ï¼Œåˆ™ï¼š

- a çš„ Ï†(N) æ¬¡æ–¹åœ¨æ¨¡ N ä¸‹æ’ç­‰äºŽ 1ã€‚
- ![image-20250727203811921](READEME.assets/image-20250727203811921.png)

------

## âœ… æ€»ç»“ä¸€ä¸‹æ•´å¼ å›¾çš„æ ¸å¿ƒæ„æ€ï¼š

1. **æ¨¡ N å¯é€†å…ƒç´ **å¿…é¡»ä¸Ž N äº’è´¨ï¼ˆå³ `gcd(x, N) = 1`ï¼‰ï¼›
2. **å¯é€†å…ƒç´ çš„æ•°é‡**æ˜¯æ¬§æ‹‰å‡½æ•° Ï†(N)ï¼›
3. **æ¬§æ‹‰å®šç†**æ˜¯ RSA å®‰å…¨æ€§çš„æ•°å­¦åŸºç¡€ä¹‹ä¸€ï¼Œå®ƒä¿è¯äº†æ¨¡é€†å…ƒå­˜åœ¨æ€§åŠ RSA åŠ è§£å¯†çš„æ­£ç¡®æ€§ã€‚

------

å¦‚ä½ éœ€è¦ï¼Œæˆ‘å¯ä»¥ç»§ç»­ç»“åˆè¿™äº›çŸ¥è¯†è§£é‡Š RSA çš„æ•´ä¸ªåŠ è§£å¯†æµç¨‹ï¼Œæˆ–è€…æ¼”ç¤ºå¦‚ä½•ç”¨æ¬§æ‹‰å®šç†å’Œæ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•æž„é€ å¯†é’¥ã€‚éœ€è¦å—ï¼Ÿ

![image-20250727203821605](READEME.assets/image-20250727203821605.png)

è¿™å¼ å¹»ç¯ç‰‡ä»‹ç»çš„æ˜¯**ä¸­å›½å‰©ä½™å®šç†ï¼ˆChinese Remainder Theoremï¼Œç®€ç§° CRTï¼‰**ï¼Œå®ƒæ˜¯æ•°è®ºä¸­éžå¸¸é‡è¦çš„ä¸€æ¡å®šç†ï¼Œå¹¿æ³›åº”ç”¨äºŽå¯†ç å­¦ï¼ˆå¦‚RSAè§£å¯†åŠ é€Ÿï¼‰ã€æ¨¡è¿ç®—è®¡ç®—ç­‰é¢†åŸŸã€‚

ä¸‹é¢æˆ‘æ¥è¿›è¡Œé€æ¡ä¸­æ–‡è¯¦ç»†è®²è§£ï¼š

------

## ðŸ§  ä¸­å›½å‰©ä½™å®šç†çš„æœ¬è´¨ï¼š

> ä¸­å›½å‰©ä½™å®šç†è§£å†³çš„é—®é¢˜æ˜¯ï¼š
>  **å¦‚ä½•æ±‚è§£ä¸€ç»„æ¨¡æ•°äº’ç´ çš„çº¿æ€§åŒä½™æ–¹ç¨‹ç»„çš„é€šè§£ï¼Ÿ**

------

### ðŸ”¢ å·¦è¾¹å…¬å¼éƒ¨åˆ†è§£é‡Šï¼š

è¿™æ˜¯ä¸€ç»„æ¨¡æ–¹ç¨‹ï¼š

```
x â‰¡ aâ‚ (mod mâ‚)      æ¯”å¦‚ x â‰¡ 2 mod 3  
x â‰¡ aâ‚‚ (mod mâ‚‚)      æ¯”å¦‚ x â‰¡ 3 mod 5  
...  
x â‰¡ aáµ£ (mod máµ£)      æ¯”å¦‚ x â‰¡ 2 mod 7
```

è¿™äº›æ¨¡æ•° `mâ‚, mâ‚‚, ..., máµ£` éƒ½æ˜¯**ä¸¤ä¸¤äº’ç´ **ï¼ˆå³ `gcd(máµ¢, mâ±¼) = 1`ï¼Œå¯¹äºŽä»»æ„ i â‰  jï¼‰ã€‚

------

### âœ… ä¸­å›½å‰©ä½™å®šç†çš„ç»“è®ºï¼š

> å¯¹äºŽè¿™ç»„åŒä½™æ–¹ç¨‹ï¼Œå¦‚æžœæ¨¡æ•°ä¹‹é—´äº’ç´ ï¼Œå°±ä¸€å®šå­˜åœ¨ä¸€ä¸ªå”¯ä¸€çš„è§£ `x`ï¼Œæ»¡è¶³è¿™äº›å¼å­ï¼Œä¸”è¿™ä¸ªè§£åœ¨æ¨¡ `M = mâ‚ Ã— mâ‚‚ Ã— ... Ã— máµ£` æ„ä¹‰ä¸‹æ˜¯**å”¯ä¸€çš„**ã€‚

------

### ðŸ“Œ ä¸¾ä¸ªä¾‹å­æ¥è¯´æ˜Žï¼š

ç»™å®šï¼š

```
x â‰¡ 2 mod 3  
x â‰¡ 3 mod 5  
x â‰¡ 2 mod 7  
```

æˆ‘ä»¬æƒ³æ‰¾å‡ºä¸€ä¸ªæ»¡è¶³è¿™ä¸‰æ¡æ¡ä»¶çš„æœ€å°æ­£æ•´æ•° `x`ã€‚

æ ¹æ®ä¸­å›½å‰©ä½™å®šç†ï¼Œ**ä¸€å®šå­˜åœ¨å”¯ä¸€è§£ï¼ˆmod 105ï¼‰**ï¼ˆå› ä¸º 3Ã—5Ã—7=105ï¼‰ï¼Œå³ï¼š

```
x â‰¡ 23 mod 105 âœ…
```

ä¹Ÿå°±æ˜¯è¯´ï¼Œ`x = 23` åŒæ—¶æ»¡è¶³ï¼š

- 23 â‰¡ 2 mod 3
- 23 â‰¡ 3 mod 5
- 23 â‰¡ 2 mod 7

------

### ðŸ” é€šè§£ï¼ˆgeneral solutionï¼‰

å¹»ç¯ç‰‡ä¸­å†™äº†ï¼š

> One possible solution: x = 23
>  General solution is: x = 23 + 105k ï¼ˆk âˆˆ â„¤ï¼‰

å³ï¼šæ‰€æœ‰è§£çš„å½¢å¼éƒ½æ˜¯ï¼š

> **x â‰¡ 23 mod 105**

------

### ðŸ“¦ å³è¾¹ç°æ¡†è§£é‡Šï¼š

å®ƒè¯´æ˜Žäº†ä¸€ä¸ªç‰¹åˆ«æƒ…å†µï¼ˆä¹Ÿå¸¸å‡ºçŽ°åœ¨ RSA ä¸­ï¼‰ï¼š

- x â‰¡ a mod p
- x â‰¡ a mod q

é‚£ä¹ˆå°±æœ‰ x â‰¡ a mod pq ï¼ˆå› ä¸º p, q äº’ç´ ï¼‰

è¿™ä¸ªåŽŸç†ç”¨åœ¨ **RSA åŠ é€Ÿè§£å¯†ç®—æ³•** ä¸­ï¼ˆCRT-RSAï¼‰ï¼ŒæŠŠæ¨¡ Nï¼ˆpÃ—qï¼‰çš„è¿ç®—åˆ†è§£æˆæ¨¡ p å’Œæ¨¡ q ä¸¤ä¸ªå°æ¨¡æ•°çš„è®¡ç®—ï¼Œæé«˜æ•ˆçŽ‡ã€‚

------

## ðŸ”‘ æ€»ç»“æ ¸å¿ƒå†…å®¹ï¼š

| å†…å®¹            | ä¸­æ–‡è§£é‡Š                                    |
| --------------- | ------------------------------------------- |
| `x â‰¡ aáµ¢ mod máµ¢` | ä¸€ç»„åŒä½™æ–¹ç¨‹ï¼Œæ¨¡æ•°äº’ç´                       |
| æ¡ä»¶            | æ‰€æœ‰ `máµ¢` ä¸¤ä¸¤äº’ç´                           |
| ä¿è¯            | å­˜åœ¨å”¯ä¸€è§£ `x`ï¼ˆåœ¨ mod M ä¸‹ï¼‰               |
| è§£çš„å½¢å¼        | **x = æŸä¸ªç‰¹è§£ + M Ã— k**ï¼Œå³ `x â‰¡ è§£ mod M` |
| ç”¨é€”            | æ¨¡è¿ç®—è§£æ³•ä¼˜åŒ–ã€RSA è§£å¯†åŠ é€Ÿã€å¹¶è¡Œè®¡ç®—ç­‰    |

------

å¦‚ä½ æ„¿æ„ï¼Œæˆ‘å¯ä»¥ç”¨ä¸€æ­¥æ­¥æ‰‹ç®—çš„æ–¹å¼å¸¦ä½ ç”¨ä¸­å›½å‰©ä½™å®šç†æ‰‹åŠ¨è§£ä¸Šé¢çš„ä¾‹å­ï¼š
 x â‰¡ 2 mod 3
 x â‰¡ 3 mod 5
 x â‰¡ 2 mod 7

ä½ éœ€è¦å—ï¼Ÿ

![image-20250727203950706](READEME.assets/image-20250727203950706.png)

è¿™å¼ å›¾å±•ç¤ºçš„æ˜¯ **RSA å¯†é’¥ç”Ÿæˆï¼ˆRSA Key Generationï¼‰** çš„å®Œæ•´æµç¨‹ï¼Œæ˜¯å­¦ä¹ éžå¯¹ç§°åŠ å¯†ç®—æ³•ï¼ˆå¦‚ RSAï¼‰çš„åŸºç¡€éƒ¨åˆ†ã€‚ä¸‹é¢æˆ‘å°†é€è¡Œè¿›è¡Œè¯¦ç»†ä¸­æ–‡è§£é‡Šï¼š

------

## ðŸ” æ ‡é¢˜ï¼šRSA Key Generation

è¿™éƒ¨åˆ†è®²çš„æ˜¯å¦‚ä½•æ ¹æ®å¯†é’¥é•¿åº¦ `n` æ¥ç”Ÿæˆä¸€å¯¹ RSA å¯†é’¥ï¼š**å…¬é’¥ (public key)** å’Œ **ç§é’¥ (secret key)**ã€‚

------

## ðŸ“¥ Inputï¼ˆè¾“å…¥ï¼‰ï¼škey length `n`

- è¡¨ç¤ºä½ æƒ³è¦çš„å¯†é’¥é•¿åº¦ï¼ˆæ¯”å¦‚ 1024 ä½ã€2048 ä½ï¼‰ã€‚
- è¾“å…¥å½¢å¼æ˜¯ `1â¿`ï¼Œè¿™æ˜¯ç†è®ºè®¡ç®—å¤æ‚åº¦ä¸­çš„æ ‡å‡†ç¬¦å·ã€‚

------

## ðŸ“ å¯†é’¥ç”Ÿæˆæ­¥éª¤è¯¦è§£ï¼š

### âœ… Step 1ï¼šç”Ÿæˆä¸¤ä¸ªå¤§çš„ä¸ç›¸ç­‰çš„ç´ æ•° p å’Œ q

**Generate two large n-bit distinct primes p and q**

- ä½¿ç”¨ç´ æ€§æµ‹è¯•ï¼ˆå¦‚å›¾å³æ³¨é‡Šï¼š**Miller-Rabin ç´ æ€§æµ‹è¯•**ï¼‰æ¥åˆ¤æ–­ç”Ÿæˆçš„æ•°æ˜¯å¦ä¸ºç´ æ•°ï¼›
- **p â‰  q** æ˜¯ä¸ºäº†å®‰å…¨æ€§ï¼Œé¿å…æ”»å‡»è€…åªéœ€è¦åˆ†è§£ä¸€ä¸ªå¹³æ–¹å› å­ï¼›
- p å’Œ q æ˜¯ä¿å¯†çš„ï¼Œä¸ä¼šç›´æŽ¥å…¬å¼€ã€‚

------

### âœ… Step 2ï¼šè®¡ç®—æ¨¡æ•° N ä»¥åŠæ¬§æ‹‰å‡½æ•° Ï†(N)

**Compute N = p Â· q å’Œ Ï†(N) = (pâˆ’1)(qâˆ’1)**

- `N = p Ã— q` æ˜¯ RSA çš„æ ¸å¿ƒæ¨¡æ•°ï¼Œ**æ—¢æ˜¯åŠ å¯†ä¹Ÿç”¨äºŽè§£å¯†çš„â€œè¿ç®—ç©ºé—´â€**ï¼›
- Ï†(N) æ˜¯ Eulerâ€™s totient functionï¼Œç”¨äºŽåŽç»­è®¡ç®—é€†å…ƒï¼›
- åœ¨ N è¢«å…¬å¼€çš„å‰æä¸‹ï¼ŒÏ†(N) çš„å…·ä½“å€¼åªæœ‰çŸ¥é“ p å’Œ q æ‰èƒ½ç®—å‡ºæ¥ã€‚

------

### âœ… Step 3ï¼šé€‰æ‹©å…¬é’¥æŒ‡æ•° e

**Choose a random integer eï¼Œè¦æ±‚ gcd(e, Ï†(N)) = 1**

- `e` å¿…é¡»å’Œ Ï†(N) äº’è´¨ï¼Œæ‰èƒ½æœ‰é€†å…ƒï¼›
- å¸¸è§çš„é€‰æ‹©æ˜¯ `e = 65537`ï¼Œå®ƒæ˜¯ä¸€ä¸ªå¸¸ç”¨çš„ç´ æ•°ï¼Œè®¡ç®—é«˜æ•ˆä¸”å®‰å…¨ï¼›
- `e` æ˜¯**å…¬å¼€çš„**ï¼Œå°†ä½œä¸ºåŠ å¯†æŒ‡æ•°ã€‚

------

### âœ… Step 4ï¼šè®¡ç®— e çš„æ¨¡é€†å…ƒ d

**Compute d: d Â· e â‰¡ 1 mod Ï†(N)**

- ä½¿ç”¨æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•æ¥æ±‚é€†å…ƒï¼›

- `d` æ˜¯ç§é’¥æŒ‡æ•°ï¼Œæ»¡è¶³ï¼š

  > â€ƒâ€ƒ**d Ã— e â‰¡ 1 mod Ï†(N)**
  >  ä¹Ÿå°±æ˜¯è¯´ï¼Œ**d æ˜¯ e åœ¨ Ï†(N) ä¸‹çš„ä¹˜æ³•é€†å…ƒ**ï¼›

- `d` æ˜¯**ç§å¯†çš„**ï¼Œåªèƒ½ç”±åˆæ³•æŽ¥æ”¶è€…ä½¿ç”¨ã€‚

------

## ðŸ“¤ Outputï¼ˆè¾“å‡ºï¼‰ï¼š

- **å…¬é’¥ pk = (N, e)**
  - `N`ï¼šæ¨¡æ•°
  - `e`ï¼šåŠ å¯†æŒ‡æ•°
  - ç”¨äºŽåŠ å¯†æ•°æ®ï¼Œå¯¹æ‰€æœ‰äººå…¬å¼€
- **ç§é’¥ sk = (N, d)**
  - `N`ï¼šæ¨¡æ•°ï¼ˆåŒæ ·ï¼‰
  - `d`ï¼šè§£å¯†æŒ‡æ•°
  - ç”¨äºŽè§£å¯†æ•°æ®ï¼Œå¿…é¡»ä¿å¯†

------

## ðŸ”‘ RSA åŠ å¯†è§£å¯†å…³ç³»ï¼š

- åŠ å¯†ï¼šâ€ƒâ€ƒ**C = M^e mod N**ï¼ˆå…¬é’¥åŠ å¯†ï¼‰
- è§£å¯†ï¼šâ€ƒâ€ƒ**M = C^d mod N**ï¼ˆç§é’¥è§£å¯†ï¼‰

åªè¦ä¿è¯ d Ã— e â‰¡ 1 mod Ï†(N)ï¼ŒåŠ å¯†å’Œè§£å¯†å°±èƒ½äº’ä¸ºé€†è¿‡ç¨‹ã€‚

------

## âœ… æ€»ç»“ä¸€å¥è¯ï¼š

> è¿™å¼ å›¾æè¿°äº† RSA å¯†é’¥ç”Ÿæˆçš„å®Œæ•´è¿‡ç¨‹ï¼š
>  ä»Žé€‰å–ä¸¤ä¸ªå¤§ç´ æ•° pã€q å¼€å§‹ï¼Œé€šè¿‡è®¡ç®— N å’Œ Ï†(N)ï¼Œé€‰æ‹©å…¬é’¥ eï¼Œè®¡ç®—ç§é’¥ dï¼Œ
>  æœ€ç»ˆç”Ÿæˆä¸€å¯¹å¯†é’¥ (N, e)ã€(N, d)ï¼Œä¾›åŠ å¯†ä¸Žè§£å¯†ä½¿ç”¨ã€‚

------

å¦‚æžœä½ éœ€è¦ï¼Œæˆ‘å¯ä»¥æ¼”ç¤ºä¸€ä¸ªå°è§„æ¨¡ RSA å¯†é’¥çš„å®Œæ•´è®¡ç®—æµç¨‹ï¼ŒåŒ…æ‹¬å¦‚ä½•é€‰ p, q, ç®— Nã€Ï†(N)ã€e å’Œ dã€‚éœ€è¦å—ï¼Ÿ

![image-20250727204221794](READEME.assets/image-20250727204221794.png)

è¿™å¼ å›¾è®²è§£çš„æ˜¯**â€œæ•™ç§‘ä¹¦ç‰ˆæœ¬ï¼ˆTextbook RSAï¼‰â€çš„åŠ å¯†ä¸Žè§£å¯†æµç¨‹**ï¼Œæ˜¯æœ€åŸºç¡€ã€æœ€åŽŸå§‹çš„ RSA åŠ å¯†æ–¹æ³•ã€‚æˆ‘ä»¬ä¸‹é¢é€è¡Œè¿›è¡Œè¯¦ç»†ä¸­æ–‡è§£é‡Šï¼š

------

## ðŸ§  æ ¸å¿ƒç›®çš„ï¼š

RSA æ˜¯ä¸€ç§**éžå¯¹ç§°åŠ å¯†ç®—æ³•**ï¼Œå³ä½¿ç”¨ä¸€å¯¹å¯†é’¥ï¼š

- **å…¬é’¥ï¼ˆpublic keyï¼‰**ï¼šåŠ å¯†ç”¨
- **ç§é’¥ï¼ˆsecret keyï¼‰**ï¼šè§£å¯†ç”¨

------

## ðŸ” KeyGenï¼šå¯†é’¥ç”Ÿæˆ

> â€ƒ**pk = (N, e)**ï¼šå…¬é’¥ï¼ŒåŒ…å«æ¨¡æ•° `N` å’ŒåŠ å¯†æŒ‡æ•° `e`
>  **sk = (N, d)**ï¼šç§é’¥ï¼ŒåŒ…å«æ¨¡æ•° `N` å’Œè§£å¯†æŒ‡æ•° `d`

è¿™äº›æ¥è‡ªå‰ä¸€å¼ å¹»ç¯ç‰‡çš„å¯†é’¥ç”Ÿæˆè¿‡ç¨‹ï¼Œå…¶ä¸­ï¼š

- `N = p Ã— q`ï¼ˆä¸¤ä¸ªå¤§ç´ æ•°çš„ä¹˜ç§¯ï¼‰
- `Ï†(N) = (pâ€“1)(qâ€“1)`
- `e` æ˜¯ä¸Ž Ï†(N) äº’ç´ çš„æ•°
- `d` æ˜¯ `e` å…³äºŽæ¨¡ Ï†(N) çš„é€†å…ƒï¼š`eÂ·d â‰¡ 1 mod Ï†(N)`

------

## ðŸ”’ Encï¼šåŠ å¯†è¿‡ç¨‹

> â€ƒ**ç»™å®šå…¬é’¥ (N, e) å’Œæ˜Žæ–‡ mï¼Œè®¡ç®—å¯†æ–‡ï¼š**

![image-20250727204337607](READEME.assets/image-20250727204337607.png)

å…¶ä¸­ï¼š

- `m` æ˜¯æ˜Žæ–‡æ¶ˆæ¯ï¼Œè¦æ±‚ `0 â‰¤ m < N`ï¼ˆå±žäºŽæ¨¡ N çš„æ•´æ•°åŸŸ ZNï¼‰
- `e` æ˜¯åŠ å¯†æŒ‡æ•°
- `c` æ˜¯å¯†æ–‡

ðŸ”Ž åŠ å¯†çš„æœ¬è´¨æ˜¯ï¼š**å°†æ˜Žæ–‡ m æå‡ä¸º e æ¬¡å¹‚ï¼Œç„¶åŽå¯¹ N å–æ¨¡**

------

## ðŸ”“ Decï¼šè§£å¯†è¿‡ç¨‹

> â€ƒ**ç»™å®šç§é’¥ (N, d) å’Œå¯†æ–‡ cï¼Œè¿˜åŽŸæ˜Žæ–‡ï¼š**

![image-20250727204330690](READEME.assets/image-20250727204330690.png)

å…¶ä¸­ï¼š

- `d` æ˜¯ç§é’¥æŒ‡æ•°ï¼ˆè§£å¯†æŒ‡æ•°ï¼‰
- `c` æ˜¯å¯†æ–‡
- `m` æ˜¯è¿˜åŽŸå‡ºçš„æ˜Žæ–‡

âœ… ç”±äºŽ `eÂ·d â‰¡ 1 mod Ï†(N)`ï¼Œæ‰€ä»¥ç”±æ¬§æ‹‰å®šç†æˆ–è´¹é©¬å°å®šç†å¯å¾—ï¼š

![image-20250727204321491](READEME.assets/image-20250727204321491.png)

å³ï¼šåŠ å¯†å†è§£å¯†ï¼Œç­‰ä»·äºŽè¿˜åŽŸåŽŸæ–‡ã€‚

------

## ðŸ§¨ é‡è¦æç¤ºï¼šä¸ºä»€ä¹ˆå« â€œTextbook RSAâ€

æ‰€è°“ â€œTextbook RSAâ€ å°±æ˜¯æŒ‡**æœ€åŽŸå§‹çš„ RSAï¼Œæ²¡æœ‰åŠ å…¥å¡«å……ï¼ˆpaddingï¼‰æˆ–ä»»ä½•éšæœºåŒ–**ï¼Œå®ƒåœ¨å®žé™…ä½¿ç”¨ä¸­æ˜¯ä¸å®‰å…¨çš„ï¼Œå®¹æ˜“å—åˆ°ä»¥ä¸‹æ”»å‡»ï¼š

- **æ˜Žæ–‡æ”»å‡»ï¼ˆKnown Plaintext Attackï¼‰**
- **é€‰æ‹©å¯†æ–‡æ”»å‡»ï¼ˆCCAï¼‰**
- **ä¸ä½¿ç”¨å¡«å……æ˜“è¢«ä»£æ•°ç»“æž„åˆ©ç”¨**

æ‰€ä»¥å®žé™…ä½¿ç”¨æ—¶ï¼Œé€šå¸¸ä½¿ç”¨æ›´å®‰å…¨çš„ç‰ˆæœ¬ï¼Œæ¯”å¦‚ï¼š

- **RSA-OAEP**ï¼šåŠ å¯†ç”¨çš„å¡«å……æ ‡å‡†
- **RSA-PSS**ï¼šç­¾åç”¨çš„å¡«å……æ ‡å‡†

------

## âœ… æ€»ç»“ä¸€å¥è¯ï¼š

> Textbook RSA æ˜¯æœ€åŸºç¡€çš„ RSA åŠ å¯†/è§£å¯†æœºåˆ¶ï¼Œ
>  åˆ©ç”¨å…¬é’¥è¿›è¡ŒåŠ å¯†ï¼š`c = m^e mod N`
>  ç”¨ç§é’¥è¿›è¡Œè§£å¯†ï¼š`m = c^d mod N`
>  å…¶æ­£ç¡®æ€§ä¾èµ–äºŽ `eÂ·d â‰¡ 1 mod Ï†(N)` å’Œæ¨¡å¹‚è¿ç®—çš„å¯é€†æ€§ã€‚

------

å¦‚æžœä½ éœ€è¦ï¼Œæˆ‘å¯ä»¥æ‰‹å·¥æ¼”ç¤ºä¸€ä¸ªå®Œæ•´çš„å°æ•°å€¼ RSA åŠ å¯†/è§£å¯†è¿‡ç¨‹ï¼ˆä¾‹å¦‚ç”¨ N = 33, e = 3, m = 7 è¿™ç±»å°æ•°å€¼ï¼‰ã€‚éœ€è¦å—ï¼Ÿ

![image-20250727204416384](READEME.assets/image-20250727204416384.png)

![image-20250727204444394](READEME.assets/image-20250727204444394.png)

![image-20250727204814998](READEME.assets/image-20250727204814998.png)

![image-20250727204520849](READEME.assets/image-20250727204520849.png)

![image-20250727204529807](READEME.assets/image-20250727204529807.png)

![image-20250727204538907](READEME.assets/image-20250727204538907.png)

![image-20250727204837999](READEME.assets/image-20250727204837999.png)

è¿™å¼ å›¾æ˜¯ä¸€ä¸ª **RSA å¯†é’¥ç”Ÿæˆçš„å®Œæ•´ä¾‹å­ï¼ˆRSA Example - Key Setupï¼‰**ï¼Œå®ƒè¯¦ç»†å±•ç¤ºäº†å¦‚ä½•ä¸€æ­¥æ­¥è®¡ç®—å‡º RSA çš„å…¬é’¥å’Œç§é’¥ã€‚ä¸‹é¢æˆ‘æŒ‰ç…§æ­¥éª¤ç”¨ä¸­æ–‡é€è¡Œè¯¦ç»†è§£é‡Šï¼š

------

## ðŸ§¾ RSA å¯†é’¥ç”Ÿæˆå®žä¾‹è¯¦è§£ï¼š

------

### âœ… ç¬¬ 1 æ­¥ï¼šé€‰æ‹©ä¸¤ä¸ªç´ æ•°

```
Select primes: p = 17, q = 11
```

é€‰æ‹©ä¸¤ä¸ªè´¨æ•° `p` å’Œ `q`ã€‚è¿™æ˜¯ RSA çš„åŸºç¡€æ­¥éª¤ã€‚
 åœ¨å®žé™…ä¸­ï¼Œp å’Œ q ä¼šå¾ˆå¤§ï¼ˆ512ä½ä»¥ä¸Šï¼‰ï¼Œè¿™é‡Œä¸ºäº†æ¼”ç¤ºç”¨å°æ•°å€¼ã€‚

------

### âœ… ç¬¬ 2 æ­¥ï¼šè®¡ç®—æ¨¡æ•° n

```
n = p Ã— q = 17 Ã— 11 = 187
```

RSA ä¸­çš„æ¨¡æ•° `n` æ˜¯ p å’Œ q çš„ä¹˜ç§¯ï¼Œç”¨äºŽåŠ è§£å¯†æ—¶çš„â€œæ¨¡ç©ºé—´â€ã€‚

------

### âœ… ç¬¬ 3 æ­¥ï¼šè®¡ç®—æ¬§æ‹‰å‡½æ•° Ï†(n)

```
Ï†(n) = (pâˆ’1)(qâˆ’1) = 16 Ã— 10 = 160
```

æ¬§æ‹‰å‡½æ•° `Ï†(n)` è¡¨ç¤ºå°äºŽ n ä¸”ä¸Ž n äº’ç´ çš„æ•°çš„ä¸ªæ•°ã€‚RSA ä¸­ç”¨å®ƒæ¥ç”Ÿæˆç§é’¥ã€‚

------

### âœ… ç¬¬ 4 æ­¥ï¼šé€‰æ‹©å…¬é’¥æŒ‡æ•° e

```
Select e: gcd(e, 160) = 1 ; choose e = 7
```

é€‰æ‹©ä¸€ä¸ªæ•´æ•° `e`ï¼Œè¦æ±‚å®ƒä¸Ž `Ï†(n)` äº’è´¨ã€‚è¿™é‡Œé€‰æ‹© `e = 7`ï¼Œå› ä¸ºï¼š

gcdâ¡(7,160)=1\gcd(7, 160) = 1

e å°±æ˜¯**åŠ å¯†æŒ‡æ•°**ï¼Œå°†ä½œä¸ºå…¬é’¥çš„ä¸€éƒ¨åˆ†ã€‚

------

### âœ… ç¬¬ 5 æ­¥ï¼šæ±‚å‡ºç§é’¥æŒ‡æ•° d

```
Determine d: d Â· e â‰¡ 1 mod 160, and d < 160
```

ç›®æ ‡æ˜¯æ‰¾ä¸€ä¸ªæ•´æ•° `d`ï¼Œä½¿å¾—ï¼š

dÃ—eâ‰¡1modâ€‰â€‰Ï†(n)å³dÃ—7â‰¡1modâ€‰â€‰160d Ã— e â‰¡ 1 \mod Ï†(n) \quad å³ \quad d Ã— 7 â‰¡ 1 \mod 160

------

#### âœ… ä½¿ç”¨æ¬§å‡ é‡Œå¾—æ‰©å±•ç®—æ³•ï¼ˆæ­¥éª¤ 5.1ï¼‰

```
Use Euclid's Inverse algorithm
```

ä½¿ç”¨æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•æ¥æ±‚ `e` åœ¨æ¨¡ Ï†(n) ä¸‹çš„é€†å…ƒã€‚

------

#### âœ… è®¡ç®—å¾—åˆ° d = 23ï¼ˆæ­¥éª¤ 5.2ï¼‰

```
Value is d = 23, since 23 Ã— 7 = 161 = 10 Ã— 160 + 1
```

è¯´æ˜ŽéªŒè¯æˆç«‹ï¼š

23Ã—7=161â‰¡1modâ€‰â€‰16023 Ã— 7 = 161 â‰¡ 1 \mod 160

æ‰€ä»¥ï¼š
 **d = 23** æ˜¯ 7 åœ¨ mod 160 ä¸‹çš„æ¨¡é€†å…ƒï¼ˆå³ç§é’¥æŒ‡æ•°ï¼‰ã€‚

------

### âœ… ç¬¬ 6 æ­¥ï¼šå‘å¸ƒå…¬é’¥

```
Publish public key PU = {7, 187}
```

å°† `(e, n) = (7, 187)` ä½œä¸ºå…¬é’¥å‘å¸ƒï¼Œç”¨äºŽåŠ å¯†ã€‚

------

### âœ… ç¬¬ 7 æ­¥ï¼šä¿ç•™ç§é’¥

```
Keep secret private key PR = {23, 187}
```

å°† `(d, n) = (23, 187)` ä½œä¸ºç§é’¥ä¿å¯†ï¼Œç”¨äºŽè§£å¯†ã€‚

------

![image-20250727205019824](READEME.assets/image-20250727205019824.png)

![image-20250727205040838](READEME.assets/image-20250727205040838.png)

è¿™å¼ å›¾å±•ç¤ºçš„æ˜¯åˆšæ‰é‚£ç»„ RSA å¯†é’¥çš„å®žé™…åº”ç”¨ï¼š**ä¸€ä¸ªå®Œæ•´çš„åŠ å¯†ä¸Žè§£å¯†å®žä¾‹**ï¼ŒåŒ…æ‹¬åŠ å¯†æ˜Žæ–‡ `m = 88`ï¼Œä»¥åŠå¦‚ä½•ç”¨ç§é’¥è§£å¯†è¿˜åŽŸå›žæ˜Žæ–‡ã€‚

ä¸‹é¢æ˜¯é€æ¡çš„è¯¦ç»†ä¸­æ–‡è§£é‡Šï¼š

------

## ðŸ” RSA åŠ å¯† & è§£å¯†ç¤ºä¾‹ï¼ˆRSA Example - En/Decryptionï¼‰

------

### âœ… è¾“å…¥æ˜Žæ–‡ï¼š

```
Given a message M = 88  ï¼ˆä¸” 88 < 187ï¼‰
```

æˆ‘ä»¬è¦åŠ å¯†çš„æ˜Žæ–‡æ˜¯ 88ã€‚ç”±äºŽ RSA è¦æ±‚æ˜Žæ–‡ `m` å¿…é¡»å°äºŽæ¨¡æ•° `n = 187`ï¼Œæ‰€ä»¥è¿™ä¸ªè¾“å…¥æ˜¯åˆæ³•çš„ã€‚

------

### âœ… åŠ å¯†è¿‡ç¨‹ï¼š

```
Its encryption is:  
C = 88^7 mod 187 = 11
```

![image-20250727205136065](READEME.assets/image-20250727205136065.png)

------

### âœ… è§£å¯†è¿‡ç¨‹ï¼š

```
Its decryption is:  
M = 11^23 mod 187 = 88
```

- ![image-20250727205148375](READEME.assets/image-20250727205148375.png)

------

### ðŸ” è¡¥å……è¯´æ˜Žï¼šâ€œSquare and Multiplyâ€ ç®—æ³•æ˜¯å¦‚ä½•å‚ä¸Žçš„ï¼Ÿ

å›¾ä¸­çº¢è‰²æ ‡æ³¨æåˆ°ï¼š

> **Square and multiply algorithm**

è¿™æ˜¯ä¸€ç§é«˜æ•ˆè®¡ç®—å¤§æ•´æ•°æ¨¡å¹‚çš„æ–¹æ³•ï¼Œå¸¸ç”¨äºŽè®¡ç®—å¦‚ `88^7 mod 187` æˆ– `11^23 mod 187` è¿™ç§å¤§æŒ‡æ•°æ¨¡è¿ç®—ã€‚

æ¯”å¦‚è®¡ç®— `11^23 mod 187` æ—¶ï¼š

1. å°† 23 è½¬ä¸ºäºŒè¿›åˆ¶ï¼š`23 = 10111â‚‚`ï¼›
2. ä¾æ¬¡å¹³æ–¹å¹¶æŒ‰éœ€è¦ä¹˜ 11ï¼›
3. æ¯ä¸€æ­¥éƒ½å– mod 187ï¼›
4. è¿‡ç¨‹å¿«å¾ˆå¤šï¼Œé¿å…ç›´æŽ¥ç®—å‡º 11^23 è¿™ä¹ˆå¤§çš„æ•°ã€‚

------

## âœ… æœ€ç»ˆç»“è®ºï¼š

- æ˜Žæ–‡ `M = 88`
- åŠ å¯†åŽå¯†æ–‡ `C = 11`
- è§£å¯†åŽè¿˜åŽŸå‡º `M = 88` âœ…

![image-20250727205124199](READEME.assets/image-20250727205124199.png)

------

å¦‚ä½ éœ€è¦ï¼Œæˆ‘å¯ä»¥ç”¨â€œsquare and multiplyâ€ç®—æ³•ä¸€æ­¥æ­¥æ‰‹ç®— `11^23 mod 187` çš„è¿‡ç¨‹ï¼Œå¸®åŠ©ä½ æŽŒæ¡é«˜æ•ˆæ¨¡å¹‚è®¡ç®—çš„æ–¹æ³•ã€‚è¦ä¸è¦æˆ‘æ¼”ç¤ºä¸€ä¸‹ï¼Ÿ

![image-20250727205206324](READEME.assets/image-20250727205206324.png)

è¿™å¼ å¹»ç¯ç‰‡æå‡ºä¸€ä¸ªé‡è¦é—®é¢˜ï¼š

------

## â“How Secure is Textbook RSA?

**æ•™ç§‘ä¹¦ç‰ˆ RSA æœ‰å¤šå®‰å…¨ï¼Ÿ**

------

### ðŸ“Œ å›¾ä¸­æ ¸å¿ƒå†…å®¹è§£é‡Šå¦‚ä¸‹ï¼š

------

## ðŸ” å®‰å…¨æ€§å®šä¹‰ï¼ˆSecurity Definitionï¼‰

å›¾ä¸­è®²çš„æ˜¯**è¯­ä¹‰å®‰å…¨ï¼ˆsemantic securityï¼‰**ï¼Œè¿™æ˜¯çŽ°ä»£å¯†ç å­¦ä¸­å¯¹åŠ å¯†ç³»ç»Ÿçš„ä¸€é¡¹é‡è¦å®‰å…¨æ ‡å‡†ã€‚

------

### âœ… ä»€ä¹ˆæ˜¯è¯­ä¹‰å®‰å…¨ï¼ˆSemantic Securityï¼‰ï¼Ÿ

> **è¯­ä¹‰å®‰å…¨**çš„å®šä¹‰æ˜¯ï¼š
>  åŠ å¯†åŽçš„å¯†æ–‡åº”è¯¥**åœ¨ç»Ÿè®¡ä¸Šæ— æ³•åŒºåˆ†äºŽéšæœºæ•°æ®**ï¼Œå³æ”»å‡»è€…çœ‹ä¸å‡ºä»»ä½•æœ‰ç”¨çš„ä¿¡æ¯ã€‚

æ¢å¥è¯è¯´ï¼š

- æ”»å‡»è€…å³ä½¿çŸ¥é“å¯†æ–‡ï¼Œä¹Ÿ**ä¸èƒ½çŒœå‡ºæ˜Žæ–‡çš„å“ªæ€•ä¸€ç‚¹ç‚¹ä¿¡æ¯**ï¼›
- å†ç›´ç™½ä¸€ç‚¹ï¼š**å¯†æ–‡çœ‹èµ·æ¥å°±åƒå®Œå…¨éšæœºçš„å­—ç¬¦ä¸²**ã€‚

è¿™æ˜¯çŽ°ä»£åŠ å¯†ç®—æ³•ï¼ˆå¦‚ AESã€RSA+paddingï¼‰è¿½æ±‚çš„åŸºæœ¬ç›®æ ‡ã€‚

------

### âŒ æ•™ç§‘ä¹¦ç‰ˆ RSA å­˜åœ¨çš„é—®é¢˜ï¼š

> â€œBut textbook RSA is not semantically secure; many attacks existâ€

æ•™ç§‘ä¹¦ç‰ˆæœ¬çš„ RSA æ²¡æœ‰ä»»ä½•**å¡«å……ï¼ˆpaddingï¼‰æˆ–éšæœºæ€§**ï¼Œæ‰€ä»¥å­˜åœ¨ä¸¥é‡çš„å®‰å…¨ç¼ºé™·ï¼š

------

1. ![image-20250727205238532](READEME.assets/image-20250727205238532.png)

------

## âœ… å¦‚ä½•æ”¹è¿›æ•™ç§‘ä¹¦ RSA çš„å®‰å…¨æ€§ï¼Ÿ

åœ¨å®žé™…ä¸­ï¼Œä»Žä¸ç›´æŽ¥ä½¿ç”¨â€œTextbook RSAâ€ã€‚ç›¸åï¼Œä½¿ç”¨å®‰å…¨å¢žå¼ºç‰ˆæœ¬ï¼š

| å®‰å…¨æ”¹è¿›æ–¹å¼ | ä½œç”¨                                                |
| ------------ | --------------------------------------------------- |
| **RSA-OAEP** | åŠ å¯†æ—¶ä½¿ç”¨å¡«å……æ–¹æ¡ˆï¼ˆpaddingï¼‰ï¼Œæä¾›éšæœºæ€§ä¸Žè¯­ä¹‰å®‰å…¨ |
| **RSA-PSS**  | ç”¨äºŽæ•°å­—ç­¾åï¼Œæ›´å®‰å…¨çš„æ›¿ä»£ä¼ ç»Ÿ RSA ç­¾å             |

------

## âœ… æ€»ç»“ä¸€å¥è¯ï¼š

> æ•™ç§‘ä¹¦ç‰ˆæœ¬çš„ RSA **ä¸å…·å¤‡è¯­ä¹‰å®‰å…¨æ€§**ï¼Œå­˜åœ¨å¤šç§æ”»å‡»æ–¹å¼ï¼Œ**ä¸é€‚åˆç›´æŽ¥ç”¨äºŽå®žé™…åŠ å¯†ç³»ç»Ÿ**ã€‚
>  å®žé™…åº”ç”¨å¿…é¡»é…åˆ **å¡«å……æ–¹æ¡ˆï¼ˆpaddingï¼‰æˆ–æ··æ·†æœºåˆ¶**ï¼Œå¦‚ RSA-OAEP æ‰èƒ½ç¡®ä¿å®‰å…¨æ€§ã€‚

------

å¦‚æžœä½ éœ€è¦ï¼Œæˆ‘å¯ä»¥å¸®ä½ è¿›ä¸€æ­¥è®²è§£ OAEP æ˜¯å¦‚ä½•å·¥ä½œï¼Œæˆ–è€…å¯¹æ¯” Textbook RSA ä¸Žå®‰å…¨ RSA çš„åŠ å¯†æµç¨‹å›¾ã€‚æ˜¯å¦éœ€è¦ï¼Ÿ

![image-20250727205501612](READEME.assets/image-20250727205501612.png)

è¿™å¼ å›¾å±•ç¤ºäº†ä¸€ç§**ä¸­é—´ç›¸é‡æ”»å‡»ï¼ˆMeet-in-the-Middle Attackï¼‰**ï¼Œé’ˆå¯¹çš„æ˜¯**æ•™ç§‘ä¹¦ç‰ˆ RSAï¼ˆTextbook RSAï¼‰** çš„å…·ä½“å¼±ç‚¹ï¼Œå°¤å…¶æ˜¯åœ¨**åŠ å¯†éšæœºä¼šè¯å¯†é’¥æ—¶**ã€‚
 æˆ‘ä»¬æ¥é€æ­¥è§£è¯»è¿™å¼ å›¾ï¼Œå¹¶è§£é‡Šå®ƒèƒŒåŽçš„åŽŸç†ã€æµç¨‹å’Œå±é™©æ€§ã€‚

------

## ðŸ§  æ”»å‡»èƒŒæ™¯ä¸Žç›®æ ‡

- Web æµè§ˆå™¨ä¸Ž Web æœåŠ¡å™¨é€šè¿‡ RSA äº¤æ¢ **ä¼šè¯å¯†é’¥ k**ã€‚
- ä¼šè¯å¯†é’¥æ˜¯åŠ å¯†é€šä¿¡ä¸­çš„æ ¸å¿ƒï¼ˆæ¯”å¦‚ TLS ä¸­ç”¨å¯¹ç§°åŠ å¯†çš„ AES ä¼šç”¨ RSA æ¥åŠ å¯† AES çš„å¯†é’¥ï¼‰ã€‚
- å‡è®¾ï¼š
  - ä¼šè¯å¯†é’¥ `k` æ˜¯ 64 ä½çš„ï¼ˆæ¯”è¾ƒçŸ­ï¼‰ï¼›
  - åŠ å¯†é‡‡ç”¨æ•™ç§‘ä¹¦ RSAï¼š`c = RSA(k) = k^e mod N`

æ”»å‡»è€… Eve èƒ½çœ‹åˆ°å…¬é’¥ `(e, N)` å’Œå¯†æ–‡ `c`ï¼Œç›®æ ‡æ˜¯æ¢å¤ `k`ã€‚

------

## âš ï¸ æ”»å‡»å‰æï¼š**æ•™ç§‘ä¹¦ RSA æ˜¯ç¡®å®šæ€§åŠ å¯†ï¼Œæ— å¡«å……ï¼ˆNo paddingï¼‰**

è¿™æ˜¯æ•´ä¸ªæ”»å‡»æˆç«‹çš„å‰æã€‚å› ä¸ºæ²¡æœ‰å¡«å……ï¼Œæ˜Žæ–‡ `k` å’Œå¯†æ–‡ `c = k^e mod N` æ˜¯**ä¸€ä¸€å¯¹åº”çš„**ï¼Œå¯ä»¥æžšä¸¾è¿˜åŽŸã€‚

------

- ![image-20250727205629436](READEME.assets/image-20250727205629436.png)

------

## ðŸ” æ”»å‡»æ­¥éª¤ï¼ˆå›¾ä¸­é»„è‰²æ¡†ï¼‰ï¼š

### ðŸ”¸ Step 1ï¼šæž„å»ºè¡¨ï¼ˆå‰å‘æœç´¢ï¼‰

- æž„é€ ä¸€ä¸ªæŸ¥æ‰¾è¡¨ï¼š`c / kâ‚^e mod N`ï¼Œå…¶ä¸­ `kâ‚ âˆˆ [0, 2^34)`
- è¡¨ä¸­ä¿å­˜çš„æ˜¯ä¸­é—´å€¼ `c / kâ‚^e mod N`ï¼Œä¾›åŽé¢æŸ¥æ‰¾

è€—æ—¶çº¦ `2^34`

------

### ðŸ”¸ Step 2ï¼šå°è¯• `kâ‚‚^e`ï¼ˆé€†å‘åŒ¹é…ï¼‰

- æžšä¸¾æ‰€æœ‰å¯èƒ½çš„ `kâ‚‚ âˆˆ [0, 2^34)`
- è®¡ç®— `kâ‚‚^e mod N`ï¼Œåœ¨è¡¨ä¸­æŸ¥æ‰¾æ˜¯å¦æœ‰åŒ¹é…é¡¹

å¦‚æžœæ‰¾åˆ°äº†ï¼š

> æ­å–œä½ ï¼Œå·²ç»èŽ·å¾— `(kâ‚, kâ‚‚)` â†’ å¯æŽ¨å‡º `k = kâ‚ Ã— kâ‚‚`

åŒæ ·è€—æ—¶çº¦ `2^34`

------

## âœ… æ•´ä½“æ—¶é—´å¤æ‚åº¦ï¼š

è™½ç„¶ `k` æœ‰ `2^64` ç§å¯èƒ½ï¼Œä½†è¿™ä¸ªæ”»å‡»åªéœ€ `2^34 + 2^34 = 2^35` æ—¶é—´å’Œç©ºé—´
 æ¯”æš´åŠ›ç ´è§£å¿«äº† `2^29` å€ï¼

------

## ðŸš¨ å®‰å…¨æ€§ç»“è®ºï¼š

- è¿™æ˜¯**é’ˆå¯¹æ•™ç§‘ä¹¦ç‰ˆ RSA çš„æ”»å‡»**ï¼›
- å¦‚æžœ RSA è¢«ç›´æŽ¥ç”¨äºŽåŠ å¯†çŸ­æ•°æ®ï¼ˆå¦‚ 64-bit å¯†é’¥ï¼‰ä¸”æ— å¡«å……ï¼Œæ”»å‡»è€…å¯ä»¥é«˜æ•ˆæš´åŠ›è¿˜åŽŸï¼›
- è¿™æ˜¯ RSA å¿…é¡»ä½¿ç”¨**å¡«å……æ–¹æ¡ˆï¼ˆå¦‚ OAEPï¼‰**çš„æ ¹æœ¬åŽŸå› ä¹‹ä¸€ã€‚

------

## âœ… æ€»ç»“ï¼š

| é¡¹ç›®     | å†…å®¹                                               |
| -------- | -------------------------------------------------- |
| æ”»å‡»åç§° | ä¸­é—´ç›¸é‡æ”»å‡»ï¼ˆMeet-in-the-Middleï¼‰                 |
| å‰ææ¡ä»¶ | ä½¿ç”¨æ•™ç§‘ä¹¦ RSAï¼ŒåŠ å¯†çš„æ˜¯çŸ­æ•´æ•°ï¼ˆå¦‚ 64-bitï¼‰        |
| åˆ©ç”¨ç»“æž„ | `k = kâ‚ Ã— kâ‚‚`ï¼Œä»¥åŠ RSA çš„ä¹˜æ³•ç»“æž„                 |
| æ­¥éª¤     | æž„é€  `c / kâ‚^e` è¡¨ â†’ åŒ¹é… `kâ‚‚^e`                   |
| æ•ˆæžœ     | åœ¨ `2^35` æ—¶é—´å†…ç ´è§£å¯†é’¥                           |
| å®‰å…¨å»ºè®® | æ°¸è¿œä¸è¦ç”¨ Textbook RSAï¼Œå¿…é¡»åŠ  paddingï¼ˆå¦‚ OAEPï¼‰ |

------

å¦‚æžœä½ è¿˜æƒ³æˆ‘æ‰‹åŠ¨ä¸¾ä¾‹ç”¨å°æ•°å­—ï¼ˆæ¯”å¦‚ e = 3, N = 187ï¼‰æ¨¡æ‹Ÿè¿™ä¸ªæ”»å‡»è¿‡ç¨‹ï¼Œä¹Ÿå¯ä»¥ç»§ç»­å‘Šè¯‰æˆ‘ï¼

![image-20250727205926107](READEME.assets/image-20250727205926107.png)

![image-20250727210015401](READEME.assets/image-20250727210015401.png)

![image-20250727210022040](READEME.assets/image-20250727210022040.png)

![image-20250727210047334](READEME.assets/image-20250727210047334.png)

![image-20250727210057132](READEME.assets/image-20250727210057132.png)

![image-20250727210103666](READEME.assets/image-20250727210103666.png)

![image-20250727210137583](READEME.assets/image-20250727210137583.png)

![image-20250727210145391](READEME.assets/image-20250727210145391.png)



![image-20250727205308251](READEME.assets/image-20250727205308251.png)

è¿™æ˜¯ä¸€é“å…³äºŽ **HSMï¼ˆç¡¬ä»¶å®‰å…¨æ¨¡å—ï¼‰ä¸­æ¢å¤ RSA ç§é’¥çš„å®‰å…¨æ€§åˆ†æžé¢˜**ï¼Œé¢˜å·ä¸º **2.2**ï¼Œæ»¡åˆ† **7 åˆ†**ã€‚

æˆ‘ä»¬ä¸‹é¢é€æ¡è§£é‡Šé¢˜æ„ï¼Œå¹¶æä¾›**æ ‡å‡†å®Œæ•´ç­”æ¡ˆ**ï¼ˆé€‚åˆè€ƒè¯•ä¹¦å†™ï¼‰ã€‚

------

## âœ… é¢˜ç›®ç¿»è¯‘ä¸Žç†è§£

> **åœºæ™¯ï¼š**
>  å¦‚æžœå‘˜å·¥ä¸¢å¤±äº†ä»–ä»¬çš„ç§é’¥ï¼ŒBobï¼ˆç³»ç»Ÿç®¡ç†å‘˜ï¼‰è®¡åˆ’è®¾è®¡ä¸€ä¸ª HSM APIï¼ˆæŽ¥å£ï¼‰æ¥æ¢å¤è¯¥ç§é’¥ã€‚

**API å®šä¹‰å¦‚ä¸‹ï¼š**

```
Host -> HSM: e      // è¾“å…¥ï¼šå…¬é’¥æŒ‡æ•° e  
HSM -> Host: d      // è¾“å‡ºï¼šç§é’¥æŒ‡æ•° d
```

ä½ éœ€è¦å›žç­”ï¼š

> **è¿™ä¸ªæ–¹æ¡ˆæ˜¯å¦å¯è¡Œï¼Ÿæ˜¯å¦å®‰å…¨ï¼Ÿè¯·è§£é‡Šã€‚**

------

## â—æ ¸å¿ƒåˆ†æžï¼š

### âœ… æŠ€æœ¯ä¸Š**å¯èƒ½å®žçŽ°**ï¼Œä½†**ä¸å®‰å…¨**

æˆ‘ä»¬æ¥æ‹†è§£å®ƒçš„å«ä¹‰å’Œé£Žé™©ã€‚

------

### ðŸ” 1. æŠ€æœ¯ä¸Šæ˜¯å¦å¯è¡Œï¼Ÿ

æ˜¯çš„ï¼Œ**æŠ€æœ¯ä¸Šæ˜¯å¯èƒ½çš„**ã€‚å¦‚æžœ HSM ä¸­å­˜å‚¨äº†ï¼š

- `p` å’Œ `q`ï¼ˆRSA çš„ä¸¤ä¸ªè´¨æ•°ï¼‰ï¼Œ
   é‚£ä¹ˆå®ƒå¯ä»¥ï¼š
- è®¡ç®— Ï†(N) = (pâˆ’1)(qâˆ’1)
- ç„¶åŽé€šè¿‡æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•æ±‚å‡º `d = eâ»Â¹ mod Ï†(N)`

æ‰€ä»¥ï¼š**ç»™å®š eï¼ŒHSM å¯ä»¥è®¡ç®—å‡º dã€‚**

------

### ðŸš¨ 2. ä½†è¿™å®‰å…¨å—ï¼Ÿâ€”â€”ä¸å®‰å…¨ï¼Œ**ä¸¥é‡è¿åå¯†é’¥ä¿æŠ¤åŽŸåˆ™**

#### âœ… ä¸ºä»€ä¹ˆä¸å®‰å…¨ï¼Ÿ

- ç§é’¥ `d` æ˜¯æœ€æ•æ„Ÿçš„åŠ å¯†ææ–™ï¼›
- è‹¥ä»»æ„äººå¯ä»¥è¾“å…¥ `e` èŽ·å–å¯¹åº” `d`ï¼Œé‚£ä¹ˆï¼š
  - **æ”»å‡»è€…å°±å¯ä»¥é€šè¿‡ HSM æ¢å¤æ‰€æœ‰ç”¨æˆ·çš„ç§é’¥**
  - å®žé™…ä¸Šå˜æˆäº† **â€œå…¬é’¥â†’ç§é’¥â€æŸ¥è¯¢ç³»ç»Ÿ**

#### âš ï¸ å¯¼è‡´ä»€ä¹ˆåŽæžœï¼Ÿ

- RSA åŠ å¯†ç³»ç»Ÿå½»åº•å¤±æ•ˆï¼›
- æ²¡æœ‰ä»»ä½•è®¿é—®æŽ§åˆ¶ï¼›
- ä¸€æ—¦ HSM è¢«å…¥ä¾µæˆ–æŽ¥å£è¢«æ»¥ç”¨ï¼Œæ‰€æœ‰ç§é’¥å¯è¢«æ‰¹é‡æ³„éœ²ã€‚

------

## âœ… æ ‡å‡†è€ƒè¯•ç­”æ¡ˆï¼ˆç»“æž„åŒ–ï¼Œ7 åˆ†æ»¡åˆ†ï¼‰

------

### âœ… **Answer (7 Marks):**

Yes, technically it is possible for the HSM to compute the private key `d` given the public key exponent `e`, if the HSM stores the prime factors `p` and `q` of the RSA modulus `N`.

Since:

- Ï†(N) = (p âˆ’ 1)(q âˆ’ 1), and
- `d = eâ»Â¹ mod Ï†(N)`,

The HSM can compute `d` using the Extended Euclidean Algorithm.

**However, this design is highly insecure.**

If the HSM exposes `d` directly to any user who supplies `e`, it effectively allows recovery of any user's private key, undermining the entire security of RSA.

It violates the principle of key isolation â€” the private key should never leave the HSM or be reconstructable via an API.

**Conclusion:** While feasible, this design introduces critical vulnerabilities and should never be used in a secure system.

------

### âœ… ä¸­æ–‡æ€»ç»“ç‰ˆï¼ˆé€‚åˆä½ ç†è§£ï¼‰ï¼š

æŠ€æœ¯ä¸Šæ˜¯å¯è¡Œçš„ï¼Œä½†å®‰å…¨æ€§ä¸Šæ˜¯å®Œå…¨ä¸å¯æŽ¥å—çš„ã€‚
 å› ä¸ºè¿™æ ·è®¾è®¡çš„ HSM æŽ¥å£ **å…è®¸ä»»æ„äººæ ¹æ®å…¬é’¥æŒ‡æ•° e æŸ¥è¯¢å‡ºç§é’¥ d**ï¼Œç›¸å½“äºŽç›´æŽ¥æ³„éœ²æ‰€æœ‰å¯†é’¥ã€‚

HSM çš„æ ¸å¿ƒèŒè´£æ˜¯**å¯†é’¥ä¿æŠ¤**ï¼Œä¸æ˜¯å¯†é’¥æ³„éœ²ã€‚
 è¿™ä¸ª API ä¼šä½¿æ•´ä¸ª RSA ç³»ç»Ÿå¤±åŽ»æ„ä¹‰ï¼Œ**ä¸¥é‡è¿åå®‰å…¨è®¾è®¡åŽŸåˆ™**ã€‚

------

å¦‚ä½ è¿˜éœ€è¦æˆ‘ç”¨å›¾è§£æˆ–ä¾‹å­æ¥è¯´æ˜Žâ€œä¸ºä»€ä¹ˆè¿™ä¸ª API å¾ˆå±é™©â€ï¼Œæˆ‘ä¹Ÿå¯ä»¥è¡¥å……ã€‚æ˜¯å¦éœ€è¦ï¼Ÿ

![image-20250727205402350](READEME.assets/image-20250727205402350.png)

è¿™é“é¢˜æ˜¯å…³äºŽ **RSA å¯†é’¥å¤ç”¨ï¼ˆåŠ å¯†å’Œç­¾åä½¿ç”¨åŒä¸€å¯†é’¥ï¼‰æ˜¯å¦å®‰å…¨** çš„åˆ†æžé¢˜ï¼Œé¢˜å·ä¸º **2.3**ï¼Œæ»¡åˆ† **10 åˆ†**ï¼Œéœ€è¦æŠ€æœ¯è¯´æ˜Ž + å®‰å…¨æ€§è¯„ä»·ã€‚

------

## âœ… é¢˜ç›®ç¿»è¯‘

> Bob è¢«è¦æ±‚ä¸ºæ¯ä½å‘˜å·¥æ·»åŠ æ•°å­—ç­¾ååŠŸèƒ½ã€‚ä¸ºäº†çœäº‹ï¼Œä»–å†³å®šè®©åŠ å¯†å’Œç­¾åå…±ç”¨åŒä¸€å¯¹ RSA å¯†é’¥ï¼ˆ`N, e, d`ï¼‰ã€‚
>
> ä»–ç»™å‘˜å·¥æä¾›äº†ä¸€ä¸ªç¨‹åºï¼Œä½¿ç”¨**æ•™ç§‘ä¹¦ç‰ˆ RSA**ï¼ˆå³æ— å¡«å……ï¼‰æ¥å®žçŽ°åŠ å¯†/è§£å¯†ä¸Žç­¾å/éªŒè¯ã€‚
>
> **é—®é¢˜æ˜¯ï¼šä½¿ç”¨åŒä¸€å¯¹å¯†é’¥åšåŠ å¯†å’Œç­¾åæ˜¯å¦å®‰å…¨ï¼Ÿè¯·ä½ è¯´æ˜Žå¹¶åˆ†æžã€‚**

------

## âœ… æ ‡å‡†ç»“æž„åŒ–å›žç­”ï¼ˆæ»¡åˆ†10åˆ†ç­”æ¡ˆï¼‰

------

### ðŸ”¹ Step 1ï¼šRSA åŠ å¯†/è§£å¯†ä¸Žç­¾å/éªŒè¯çš„åŸºæœ¬æµç¨‹

- **åŠ å¯†ï¼ˆEncryptionï¼‰**
   ç»™å®šå…¬é’¥ `(e, N)` å’Œæ¶ˆæ¯ `m`ï¼ŒåŠ å¯†ä¸ºï¼š

  c=memodâ€‰â€‰Nc = m^e \mod N

- **è§£å¯†ï¼ˆDecryptionï¼‰**
   ç»™å®šç§é’¥ `(d, N)` å’Œå¯†æ–‡ `c`ï¼Œè§£å¯†ä¸ºï¼š

  m=cdmodâ€‰â€‰Nm = c^d \mod N

- **ç­¾åï¼ˆSignatureï¼‰**
   ç»™å®šç§é’¥ `(d, N)` å’Œæ¶ˆæ¯å“ˆå¸Œ `h(m)`ï¼Œç­¾åä¸ºï¼š

  s=h(m)dmodâ€‰â€‰Ns = h(m)^d \mod N

- **éªŒè¯ï¼ˆVerificationï¼‰**
   ç»™å®šå…¬é’¥ `(e, N)` å’Œç­¾å `s`ï¼ŒéªŒè¯ä¸ºï¼š

  h(m)=?semodâ€‰â€‰Nh(m) \overset{?}{=} s^e \mod N

------

### ðŸ”¹ Step 2ï¼šæ˜¯å¦èƒ½å…±ç”¨å¯†é’¥ï¼ŸæŠ€æœ¯ä¸Šå¯ä»¥ï¼Œä½†ä¸å®‰å…¨

- æŠ€æœ¯ä¸Šä½ å½“ç„¶**å¯ä»¥ä½¿ç”¨åŒä¸€ç»„ï¼ˆe, dï¼‰æ¥å®ŒæˆåŠ å¯†ä¸Žç­¾å**ï¼Œå› ä¸ºæ•°å­¦ç»“æž„æ˜¯å¯¹ç§°çš„ã€‚
- ä½†è¿™æ ·åšåœ¨**æ•™ç§‘ä¹¦ç‰ˆï¼ˆæ— å¡«å……ï¼‰RSA**ä¸­ä¼šå¯¼è‡´ä¸¥é‡å®‰å…¨é—®é¢˜ã€‚

------

### ðŸ”¥ Step 3ï¼šä¸ºä»€ä¹ˆä¸å®‰å…¨ï¼Ÿï¼ˆæ ¸å¿ƒï¼‰

#### âš ï¸![image-20250727205442130](READEME.assets/image-20250727205442130.png)

------

### âœ… Step 4ï¼šæœ€ä½³å®žè·µ

- åŠ å¯†å’Œç­¾ååº”**ä½¿ç”¨ä¸åŒçš„å¯†é’¥å¯¹**ã€‚
- å¹¶ä¸”ä½¿ç”¨å®‰å…¨å¡«å……ç®—æ³•ï¼š
  - **RSA-OAEP** ç”¨äºŽåŠ å¯†
  - **RSA-PSS** ç”¨äºŽç­¾å

------

## âœ… æ ‡å‡†è€ƒè¯•ç­”æ¡ˆï¼ˆ10 Marksï¼‰

------

### âœ… **Answer:**

Using the same RSA key pair for both encryption and digital signature is technically possible, but highly insecure â€” especially when using textbook RSA without padding.

In textbook RSA:

- Encryption:â€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒc = m^e mod N
- Decryption:â€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒm = c^d mod N
- Signing:â€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒs = m^d mod N
- Verification:â€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒm = s^e mod N

If the same key is used:

- A ciphertext can be interpreted as a valid signature, and vice versa.
- An attacker can encrypt a message and falsely claim it was signed.
- The system becomes vulnerable to chosen-message and replay attacks.
- The lack of padding means ciphertexts are deterministic and structure-leaking.

**Conclusion:**
 Sharing keys between encryption and signing **breaks the security** guarantees of both schemes. Best practice is to use **separate key pairs** and apply **proper padding (e.g., OAEP, PSS)**.

------

å¦‚æžœä½ éœ€è¦æˆ‘æ‰©å±•ä¸º**ä¸­æ–‡å®Œæ•´ç‰ˆè€ƒè¯•ç­”æ¡ˆ**ï¼Œæˆ–åŠ ä¸Šå›¾ç¤ºç»“æž„è¯´æ˜Žï¼Œä¹Ÿå¯ä»¥ç»§ç»­è¡¥å……ï¼æ˜¯å¦éœ€è¦ï¼Ÿ